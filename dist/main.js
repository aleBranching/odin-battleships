(()=>{"use strict";function e(e){let o=0;const t=e;return{isSunk:()=>o>=t,hit:()=>{o+=1},_length:t,placed:!1,coordinates:void 0}}function o(){const o=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],t=[null,e(4),e(3),e(3),e(2),e(2),e(2),e(1),e(1),e(1),e(1)],r=[],n=e=>{let o=0;return(t=>{for(let t=0;t<r.length;t++)r[t]===e&&o++})(),o<{1:4,2:3,3:2,4:1}[e]},a=e=>{const[o,t]=[Math.floor(10*Math.random()),Math.floor(10*Math.random())],r=1===Math.floor(2*Math.random());try{l(e,o,t,r)}catch(o){return a(e)}},l=(e,a,l,c)=>{if(a<0||l<0||a>10||l>10)throw new Error((e=>{console.error("can't place ship here or no more of these ships or ship too big")}));if(!n)throw new Error((e=>{console.error("can't put anymore of these ships")}));let s;if(!(()=>{const t=(()=>{const o=[];if(c){if(c){let t=a;for(let r=0;r<e;r++)if(o.push([t,l]),t++,t>10)throw new Error("Boat out of game!")}}else{let t=l;for(let r=0;r<e;r++)if(o.push([a,t]),t++,t>10)throw new Error("boat out of game!")}return o})();return!!(()=>{let e=!0;return t.forEach((t=>{const r=t[0],n=t[1];0!==o[n][r]&&(e=!1)})),e})()&&(s=[...t],!0)})()||!n(e))throw new Error("most likely ship is overlaping");{const n=(e=>{let o;for(let r=0;r<=10;r++)if(null!=t[r]&&t[r]._length===e&&!1===t[r].placed){o=r;break}return o})(e);t[n].placed=!0,r.push(e),t[n].coordinates=s,s.forEach((e=>{const t=e[0],r=e[1];o[r][t]=n}))}},c=[];return console.log("test"),{placeShip:l,gameArena:o,receiveAttack:(e,r)=>{if(0!==o[r][e]){const n=o[r][e];return t[n].hit(),!0}return c.push([e,r]),!1},allShipsSunk:()=>{let e=0;for(let o=1;o<11;o++)t[o].isSunk()&&e++;return e>=10},missedShots:c,currentShipsOBJ:t,placeShipRandomly:a}}const t=function(){const e=(e,o,t)=>document.querySelector(`.${e} .row[data-x="${o}"] .box[data-y="${t}"]`);return{renderExistingBoats:(o,t)=>{const r=([o,r])=>{e(t,o,r).style.backgroundColor="grey"};o.currentShipsOBJ.forEach((e=>{null==e||e.coordinates.forEach(r)}))},getBoxDOM:e,getXandY:e=>{const{y:o}=e.target.dataset,{x:t}=e.target.parentElement.dataset;return[t,o]},changeAllBoxesOfShip:(o,t,r)=>{const{coordinates:n}=r.currentShipsOBJ[o];n.forEach((o=>{const[r,n]=o;e(`${t}`,r,n).style.backgroundColor="red"}))},getBoxDOMsShipIndex:(e,o,t)=>e.gameArena[t][o],changeBoxColour:(o,t,r,n)=>{e(o,t,r).style.backgroundColor=n},toggleHovering:()=>{document.querySelector(".enemyArea").classList.toggle("hovering")}}}();(()=>{const e=o(),r=o();var n,a;a=r,(n=e).placeShipRandomly(4),n.placeShipRandomly(3),n.placeShipRandomly(3),n.placeShipRandomly(2),n.placeShipRandomly(2),n.placeShipRandomly(2),n.placeShipRandomly(1),n.placeShipRandomly(1),n.placeShipRandomly(1),n.placeShipRandomly(1),a.placeShipRandomly(4),a.placeShipRandomly(3),a.placeShipRandomly(3),a.placeShipRandomly(2),a.placeShipRandomly(2),a.placeShipRandomly(2),a.placeShipRandomly(1),a.placeShipRandomly(1),a.placeShipRandomly(1),a.placeShipRandomly(1);let l=!0;t.renderExistingBoats(e,"playerArea");const c=e=>{const o=e.target,[n,a]=t.getXandY(e),c=t.getBoxDOMsShipIndex(r,n,a);if(!o.dataset.hit){if(o.dataset.hit=!0,i(),r.receiveAttack(n,a)){const e=r.currentShipsOBJ[c];o.style.backgroundColor="grey",e.isSunk()&&t.changeAllBoxesOfShip(c,"enemyArea",r),r.allShipsSunk()&&(alert("game Over"),l=!1)}else o.style.backgroundColor="rgb(201, 201, 178)";p()}},s=()=>{document.querySelectorAll(".enemyArea .row .box").forEach((e=>{e.addEventListener("click",c,{once:!0})}))},i=()=>{document.querySelectorAll(".enemyArea .row .box").forEach((e=>{e.removeEventListener("click",c)})),t.toggleHovering()},h=function(e){const o=[];console.log(o);const t=()=>{const e=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());return void 0!==o.find((o=>o[0]===e&&o[1]===r))?t():[e,r]};return{attack:()=>{const[r,n]=t();console.log("random coord",r,n);const a=e.receiveAttack(r,n);return o.push([r,n]),[a,r,n]}}}(e),p=()=>{if(!l)return;const[o,r,n]=h.attack(),a=t.getBoxDOM("playerArea",r,n);if(o){const o=t.getBoxDOMsShipIndex(e,r,n),l=e.currentShipsOBJ[o];a.style.backgroundColor="pink",s(),l.isSunk()&&t.changeAllBoxesOfShip(o,"playerArea",e)}else a.style.backgroundColor="rgb(201, 201, 178)",s()};s()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RixFQUFHQyxFQUFFLEVBSXhCLENEb0htQnVGLENBQVkzQixHQUN2QlcsRUFBWSxLQUNoQixJQUFLUCxFQUNILE9BSUYsTUFBT3NCLEVBQU92RixFQUFHQyxHQUFLOEUsRUFBU08sU0FFekJHLEVBQVN2QixFQUFhL0IsVUFBVSxhQUFjbkMsRUFBR0MsR0FFdkQsR0FBSXNGLEVBQU8sQ0FDVCxNQUFNRyxFQUFpQnhCLEVBQWFYLG9CQUNsQ00sRUFDQTdELEVBQ0FDLEdBRUlxRSxFQUFVVCxFQUFnQnJFLGdCQUFnQmtHLEdBRWhERCxFQUFPL0MsTUFBTUMsZ0JBQWtCLE9BQy9COEIsSUFDSUgsRUFBUXBGLFVBQ1ZnRixFQUFhakIscUJBQ1h5QyxFQUNBLGFBQ0E3QixFQUdOLE1BRUU0QixFQUFPL0MsTUFBTUMsZ0JBQWtCLHFCQUMvQjhCLEdBQ0YsRUFHRkEsR0FBYSxFQUdma0IsRSIsInNvdXJjZXMiOlsid2VicGFjazovL29kaW4tYmF0dGxlc2hpcHMvLi9zcmMvbG9naWMvc2hpcC5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXBzLy4vc3JjL2xvZ2ljL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXBzLy4vc3JjL2xvZ2ljL1VJY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXBzLy4vc3JjL2xvZ2ljL2luZGV4LmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcHMvLi9zcmMvbG9naWMvY29tcHV0ZXJQbGF5ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gU2hpcChsZW5ndGgpIHtcbiAgbGV0IF9oaXRzID0gMDtcbiAgY29uc3QgX2xlbmd0aCA9IGxlbmd0aDtcbiAgY29uc3QgcGxhY2VkID0gZmFsc2U7XG4gIGxldCBjb29yZGluYXRlcztcblxuICBjb25zdCBoaXQgPSAoKSA9PiB7XG4gICAgX2hpdHMgKz0gMTtcbiAgfTtcblxuICBjb25zdCBpc1N1bmsgPSAoKSA9PiBfaGl0cyA+PSBfbGVuZ3RoO1xuXG4gIC8vICAgdGhpcy5sZW5ndGggPSBsZW5ndGg7XG5cbiAgLy8gICB0aGlzLl9zdW5rID0gZmFsc2U7XG4gIC8vICAgdGhpcy5faGl0cyA9IDA7XG5cbiAgLy8gICBmdW5jdGlvbiBoaXQoKSB7XG4gIC8vICAgICB0aGlzLl9oaXRzID0gKzE7XG4gIC8vICAgICAvL1xuICAvLyAgIH1cblxuICAvLyAgIGZ1bmN0aW9uIGlzU3VuaygpIHtcbiAgLy8gICAgIHJldHVybiB0aGlzLl9oaXRzID49IGxlbmd0aCA/IHRydWUgOiBmYWxzZTtcbiAgLy8gICAgIC8vXG4gIC8vICAgfVxuXG4gIHJldHVybiB7IGlzU3VuaywgaGl0LCBfbGVuZ3RoLCBwbGFjZWQsIGNvb3JkaW5hdGVzIH07XG59XG4iLCJpbXBvcnQgU2hpcCBmcm9tIFwiLi9zaGlwXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEdhbWVib2FyZCgpIHtcbiAgLy8gZWFjaCBudW1iZXIgY29ycmVzcG9uZHMgdG8gaW5kZXggb2YgY3VycmVudFNoaXBzT0JKXG4gIGNvbnN0IGdhbWVBcmVuYSA9IFtcbiAgICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gICAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gICAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gICAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gIF07XG5cbiAgY29uc3QgcG9zaXRpb25HYW1lQXJlbmEgPSBbXG4gICAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gICAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gICAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gICAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICBdO1xuXG4gIGNvbnN0IGN1cnJlbnRTaGlwc09CSiA9IFtcbiAgICBudWxsLFxuICAgIFNoaXAoNCksXG4gICAgU2hpcCgzKSxcbiAgICBTaGlwKDMpLFxuICAgIFNoaXAoMiksXG4gICAgU2hpcCgyKSxcbiAgICBTaGlwKDIpLFxuICAgIFNoaXAoMSksXG4gICAgU2hpcCgxKSxcbiAgICBTaGlwKDEpLFxuICAgIFNoaXAoMSksXG4gIF07XG5cbiAgY29uc3QgbmV3U2hpcEluZGV4ID0gKGxlbmd0aCkgPT4ge1xuICAgIGxldCBpbmRleDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSAxMDsgaSsrKSB7XG4gICAgICAvLyBjb25zb2xlLmxvZyhcIlRISVNcIiwgY3VycmVudFNoaXBzT0JKW2ldLl9sZW5ndGgpO1xuICAgICAgaWYgKGN1cnJlbnRTaGlwc09CSltpXSA9PSBudWxsKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKFxuICAgICAgICBjdXJyZW50U2hpcHNPQkpbaV0uX2xlbmd0aCA9PT0gbGVuZ3RoICYmXG4gICAgICAgIGN1cnJlbnRTaGlwc09CSltpXS5wbGFjZWQgPT09IGZhbHNlXG4gICAgICApIHtcbiAgICAgICAgaW5kZXggPSBpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGluZGV4O1xuICB9O1xuXG4gIGNvbnN0IF9wbGFjZWRTaGlwcyA9IFtdO1xuXG4gIGNvbnN0IHNoaXBOdW1iZXJSdWxlc1Bhc3NlZCA9IChsZW5ndGgpID0+IHtcbiAgICBjb25zdCBfYWxsb3dlZE9jY3VyYW5jZXMgPSB7XG4gICAgICAxOiA0LFxuICAgICAgMjogMyxcbiAgICAgIDM6IDIsXG4gICAgICA0OiAxLFxuICAgIH07XG4gICAgbGV0IGxlbmd0aE9jY2N1cmVkID0gMDtcbiAgICBjb25zdCBfb2NjdXJhbmNlcyA9ICh0YXJnZXRMZW5ndGgpID0+IHtcbiAgICAgIC8vIGxldCBjb3VudGVyID0gMDtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBfcGxhY2VkU2hpcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKF9wbGFjZWRTaGlwc1tpXSA9PT0gbGVuZ3RoKSB7XG4gICAgICAgICAgbGVuZ3RoT2NjY3VyZWQrKztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgX29jY3VyYW5jZXMoKTtcblxuICAgIGlmIChsZW5ndGhPY2NjdXJlZCA8IF9hbGxvd2VkT2NjdXJhbmNlc1tsZW5ndGhdKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgY29uc3QgZ2V0UmFuZG9tQ29vcmQgPSAoKSA9PiB7XG4gICAgY29uc3QgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICBjb25zdCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIHJldHVybiBbeCwgeV07XG4gIH07XG5cbiAgY29uc3QgZ2V0VHJ1ZU9yRmFsc2UgPSAoKSA9PiB7XG4gICAgY29uc3QgbnVtYmVyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMik7XG4gICAgaWYgKG51bWJlciA9PT0gMSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBjb25zdCBwbGFjZVNoaXBSYW5kb21seSA9IChsZW5ndGgpID0+IHtcbiAgICBjb25zdCBbeCwgeV0gPSBnZXRSYW5kb21Db29yZCgpO1xuICAgIGNvbnN0IGhvcml6b250YWxseSA9IGdldFRydWVPckZhbHNlKCk7XG5cbiAgICB0cnkge1xuICAgICAgcGxhY2VTaGlwKGxlbmd0aCwgeCwgeSwgaG9yaXpvbnRhbGx5KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZXR1cm4gcGxhY2VTaGlwUmFuZG9tbHkobGVuZ3RoKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgcGxhY2VTaGlwID0gKGxlbmd0aCwgeCwgeSwgaG9yaXpvbnRhbGx5KSA9PiB7XG4gICAgLy8gdGVzdCB2YWxpZGl0eSBvZiBjby1vcmQgb3IgYW1vdW50IG9mIHNoaXBzXG4gICAgaWYgKHggPCAwIHx8IHkgPCAwIHx8IHggPiAxMCB8fCB5ID4gMTApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigoZSkgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICAgIFwiY2FuJ3QgcGxhY2Ugc2hpcCBoZXJlIG9yIG5vIG1vcmUgb2YgdGhlc2Ugc2hpcHMgb3Igc2hpcCB0b28gYmlnXCJcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICghc2hpcE51bWJlclJ1bGVzUGFzc2VkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoKGUpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcImNhbid0IHB1dCBhbnltb3JlIG9mIHRoZXNlIHNoaXBzXCIpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgbGV0IGNoZWNrZWRDb29yZDtcblxuICAgIGNvbnN0IGNoZWNrQ29vcmQgPSAoKSA9PiB7XG4gICAgICAvLyB3aGF0IHdvdWxkIHRoZXkgYmUgbmFpdmVseVxuXG4gICAgICBjb25zdCBuYWl2ZUNvb3IgPSAoKCkgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcblxuICAgICAgICBpZiAoIWhvcml6b250YWxseSkge1xuICAgICAgICAgIGxldCBuZXdZID0geTtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaChbeCwgbmV3WV0pO1xuICAgICAgICAgICAgbmV3WSsrO1xuICAgICAgICAgICAgaWYgKG5ld1kgPiAxMCkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJib2F0IG91dCBvZiBnYW1lIVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoaG9yaXpvbnRhbGx5KSB7XG4gICAgICAgICAgbGV0IG5ld1ggPSB4O1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKFtuZXdYLCB5XSk7XG4gICAgICAgICAgICBuZXdYKys7XG4gICAgICAgICAgICBpZiAobmV3WCA+IDEwKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkJvYXQgb3V0IG9mIGdhbWUhXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9KSgpO1xuXG4gICAgICBjb25zdCBjaGVja0Zvck92ZXJsYXAgPSAoKSA9PiB7XG4gICAgICAgIGxldCBhbGxvd2VkID0gdHJ1ZTtcblxuICAgICAgICBuYWl2ZUNvb3IuZm9yRWFjaCgoY29vcmRpbmF0ZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGFuWCA9IGNvb3JkaW5hdGVbMF07XG4gICAgICAgICAgY29uc3QgYW5ZID0gY29vcmRpbmF0ZVsxXTtcblxuICAgICAgICAgIC8vIGluIGdhbWVhcmVuYSBmaXJzdCBoYXZlIHRvIGFjY2VzcyBZXG5cbiAgICAgICAgICBpZiAoZ2FtZUFyZW5hW2FuWV1bYW5YXSAhPT0gMCkge1xuICAgICAgICAgICAgYWxsb3dlZCA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGFsbG93ZWQ7XG4gICAgICB9O1xuXG4gICAgICBpZiAoY2hlY2tGb3JPdmVybGFwKCkpIHtcbiAgICAgICAgY2hlY2tlZENvb3JkID0gWy4uLm5haXZlQ29vcl07XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIC8vIGNvbnNvbGUubG9nKFwiVEhJU1wiLCBzaGlwTnVtYmVyUnVsZXNQYXNzZWQobGVuZ3RoKSk7XG4gICAgaWYgKGNoZWNrQ29vcmQoKSAmJiBzaGlwTnVtYmVyUnVsZXNQYXNzZWQobGVuZ3RoKSkge1xuICAgICAgY29uc3Qgc2hpcE9CSkluZGV4ID0gbmV3U2hpcEluZGV4KGxlbmd0aCk7XG4gICAgICBjdXJyZW50U2hpcHNPQkpbc2hpcE9CSkluZGV4XS5wbGFjZWQgPSB0cnVlO1xuICAgICAgX3BsYWNlZFNoaXBzLnB1c2gobGVuZ3RoKTtcblxuICAgICAgY3VycmVudFNoaXBzT0JKW3NoaXBPQkpJbmRleF0uY29vcmRpbmF0ZXMgPSBjaGVja2VkQ29vcmQ7XG4gICAgICBjaGVja2VkQ29vcmQuZm9yRWFjaCgoYUNvb3JkaW5hdGUpID0+IHtcbiAgICAgICAgY29uc3QgbmV3eCA9IGFDb29yZGluYXRlWzBdO1xuICAgICAgICBjb25zdCBuZXd5ID0gYUNvb3JkaW5hdGVbMV07XG5cbiAgICAgICAgZ2FtZUFyZW5hW25ld3ldW25ld3hdID0gc2hpcE9CSkluZGV4O1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIm1vc3QgbGlrZWx5IHNoaXAgaXMgb3ZlcmxhcGluZ1wiKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgcG9zaXRpb25TaGlwUmFuZG9tbHkgPSAoZmFrZUFyZW5hLCBsZW5ndGgsIHgsIHksIGhvcml6b250YWxseSkgPT4ge1xuICAgIC8vIHRlc3QgdmFsaWRpdHkgb2YgY28tb3JkIG9yIGFtb3VudCBvZiBzaGlwc1xuICAgIGlmICh4IDwgMCB8fCB5IDwgMCB8fCB4ID4gMTAgfHwgeSA+IDEwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoKGUpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICBcImNhbid0IHBsYWNlIHNoaXAgaGVyZSBvciBubyBtb3JlIG9mIHRoZXNlIHNoaXBzIG9yIHNoaXAgdG9vIGJpZ1wiXG4gICAgICAgICk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBsZXQgY2hlY2tlZENvb3JkO1xuXG4gICAgY29uc3QgY2hlY2tDb29yZCA9ICgpID0+IHtcbiAgICAgIC8vIHdoYXQgd291bGQgdGhleSBiZSBuYWl2ZWx5XG5cbiAgICAgIGNvbnN0IG5haXZlQ29vciA9ICgoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xuXG4gICAgICAgIGlmICghaG9yaXpvbnRhbGx5KSB7XG4gICAgICAgICAgbGV0IG5ld1kgPSB5O1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKFt4LCBuZXdZXSk7XG4gICAgICAgICAgICBuZXdZKys7XG4gICAgICAgICAgICBpZiAobmV3WSA+IDEwKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJvYXQgb3V0IG9mIGdhbWUhXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChob3Jpem9udGFsbHkpIHtcbiAgICAgICAgICBsZXQgbmV3WCA9IHg7XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goW25ld1gsIHldKTtcbiAgICAgICAgICAgIG5ld1grKztcbiAgICAgICAgICAgIGlmIChuZXdYID4gMTApIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQm9hdCBvdXQgb2YgZ2FtZSFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH0pKCk7XG5cbiAgICAgIGNvbnN0IGNoZWNrRm9yT3ZlcmxhcCA9ICgpID0+IHtcbiAgICAgICAgbGV0IGFsbG93ZWQgPSB0cnVlO1xuXG4gICAgICAgIG5haXZlQ29vci5mb3JFYWNoKChjb29yZGluYXRlKSA9PiB7XG4gICAgICAgICAgY29uc3QgYW5YID0gY29vcmRpbmF0ZVswXTtcbiAgICAgICAgICBjb25zdCBhblkgPSBjb29yZGluYXRlWzFdO1xuXG4gICAgICAgICAgLy8gaW4gZ2FtZWFyZW5hIGZpcnN0IGhhdmUgdG8gYWNjZXNzIFlcblxuICAgICAgICAgIGlmIChwb3NpdGlvbkdhbWVBcmVuYVthblldW2FuWF0gIT09IDApIHtcbiAgICAgICAgICAgIGFsbG93ZWQgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBhbGxvd2VkO1xuICAgICAgfTtcblxuICAgICAgaWYgKGNoZWNrRm9yT3ZlcmxhcCgpKSB7XG4gICAgICAgIGNoZWNrZWRDb29yZCA9IFsuLi5uYWl2ZUNvb3JdO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICAvLyBjb25zb2xlLmxvZyhcIlRISVNcIiwgc2hpcE51bWJlclJ1bGVzUGFzc2VkKGxlbmd0aCkpO1xuICAgIGlmIChjaGVja0Nvb3JkKCkpIHtcbiAgICAgIC8vIGNvbnN0IHNoaXBPQkpJbmRleCA9IG5ld1NoaXBJbmRleChsZW5ndGgpO1xuICAgICAgLy8gY3VycmVudFNoaXBzT0JKW3NoaXBPQkpJbmRleF0ucGxhY2VkID0gdHJ1ZTtcbiAgICAgIC8vIF9wbGFjZWRTaGlwcy5wdXNoKGxlbmd0aCk7XG5cbiAgICAgIC8vIGN1cnJlbnRTaGlwc09CSltzaGlwT0JKSW5kZXhdLmNvb3JkaW5hdGVzID0gY2hlY2tlZENvb3JkO1xuICAgICAgY2hlY2tlZENvb3JkLmZvckVhY2goKGFDb29yZGluYXRlKSA9PiB7XG4gICAgICAgIGNvbnN0IG5ld3ggPSBhQ29vcmRpbmF0ZVswXTtcbiAgICAgICAgY29uc3QgbmV3eSA9IGFDb29yZGluYXRlWzFdO1xuXG4gICAgICAgIGdhbWVBcmVuYVtuZXd5XVtuZXd4XSA9IDE7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwibW9zdCBsaWtlbHkgc2hpcCBpcyBvdmVybGFwaW5nXCIpO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgbWlzc2VkU2hvdHMgPSBbXTtcblxuICBjb25zdCByZWNlaXZlQXR0YWNrID0gKHgsIHkpID0+IHtcbiAgICBpZiAoZ2FtZUFyZW5hW3ldW3hdICE9PSAwKSB7XG4gICAgICBjb25zdCBzaGlwT0JKSW5kZXggPSBnYW1lQXJlbmFbeV1beF07XG4gICAgICBjdXJyZW50U2hpcHNPQkpbc2hpcE9CSkluZGV4XS5oaXQoKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBtaXNzZWRTaG90cy5wdXNoKFt4LCB5XSk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGNvbnN0IGFsbFNoaXBzU3VuayA9ICgpID0+IHtcbiAgICBsZXQgY291bnRlciA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCAxMTsgaSsrKSB7XG4gICAgICBpZiAoY3VycmVudFNoaXBzT0JKW2ldLmlzU3VuaygpKSB7XG4gICAgICAgIGNvdW50ZXIrKztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGNvdW50ZXIgPj0gMTApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG4gIGNvbnNvbGUubG9nKFwidGVzdFwiKTtcblxuICByZXR1cm4ge1xuICAgIHBsYWNlU2hpcCxcbiAgICBnYW1lQXJlbmEsXG4gICAgcmVjZWl2ZUF0dGFjayxcbiAgICBhbGxTaGlwc1N1bmssXG4gICAgbWlzc2VkU2hvdHMsXG4gICAgY3VycmVudFNoaXBzT0JKLFxuICAgIHBsYWNlU2hpcFJhbmRvbWx5LFxuICB9O1xufVxuIiwiaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcblxuZXhwb3J0IGRlZmF1bHQgKGZ1bmN0aW9uIFVJY29udHJvbGxlcigpIHtcbiAgY29uc3QgZ2V0Qm94RE9NID0gKGFyZWEsIHgsIHkpID0+XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLiR7YXJlYX0gLnJvd1tkYXRhLXg9XCIke3h9XCJdIC5ib3hbZGF0YS15PVwiJHt5fVwiXWApO1xuXG4gIGNvbnN0IHJlbmRlckV4aXN0aW5nQm9hdHMgPSAoZ2FtZUFyZW5hLCBwbGF5ZXJBcmVhRE9NKSA9PiB7XG4gICAgY29uc3QgdXBkYXRlRWFjaERPTUNvb3JkaW5hdGUgPSAoW3gsIHldKSA9PiB7XG4gICAgICBnZXRCb3hET00ocGxheWVyQXJlYURPTSwgeCwgeSkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJncmV5XCI7XG4gICAgfTtcblxuICAgIGdhbWVBcmVuYS5jdXJyZW50U2hpcHNPQkouZm9yRWFjaCgoYVNoaXApID0+IHtcbiAgICAgIGlmIChhU2hpcCA9PSBudWxsKSB7XG4gICAgICAgIC8vIG51bGxcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJoZXJlXCIsIGFTaGlwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFTaGlwLmNvb3JkaW5hdGVzLmZvckVhY2godXBkYXRlRWFjaERPTUNvb3JkaW5hdGUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGNoYW5nZUJveENvbG91ciA9IChhcmVhLCB4LCB5LCBjb2xvdXIpID0+IHtcbiAgICBjb25zdCBoaXRCb3hET00gPSBnZXRCb3hET00oYXJlYSwgeCwgeSk7XG4gICAgaGl0Qm94RE9NLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG91cjtcbiAgfTtcblxuICBjb25zdCB0b2dnbGVIb3ZlcmluZyA9ICgpID0+IHtcbiAgICBjb25zdCBhcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbmVteUFyZWFcIik7XG4gICAgYXJlYS5jbGFzc0xpc3QudG9nZ2xlKFwiaG92ZXJpbmdcIik7XG4gIH07XG5cbiAgY29uc3QgZ2V0Qm94RE9Nc1NoaXBJbmRleCA9IChnYW1lQXJlbmEsIHgsIHkpID0+IHtcbiAgICBjb25zdCBzaGlwSW5kZXggPSBnYW1lQXJlbmEuZ2FtZUFyZW5hW3ldW3hdO1xuICAgIHJldHVybiBzaGlwSW5kZXg7XG4gIH07XG5cbiAgY29uc3QgY2hhbmdlQWxsQm94ZXNPZlNoaXAgPSAoc2hpcEluZGV4LCBhcmVhQ2xhc3MsIGdhbWVBcmVuYSkgPT4ge1xuICAgIGNvbnN0IHsgY29vcmRpbmF0ZXMgfSA9IGdhbWVBcmVuYS5jdXJyZW50U2hpcHNPQkpbc2hpcEluZGV4XTtcbiAgICBjb29yZGluYXRlcy5mb3JFYWNoKChhQ29vcmQpID0+IHtcbiAgICAgIGNvbnN0IFtzaGlwWCwgc2hpcFldID0gYUNvb3JkO1xuICAgICAgZ2V0Qm94RE9NKGAke2FyZWFDbGFzc31gLCBzaGlwWCwgc2hpcFkpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmVkXCI7XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgZ2V0WGFuZFkgPSAoZSkgPT4ge1xuICAgIGNvbnN0IHsgeSB9ID0gZS50YXJnZXQuZGF0YXNldDtcbiAgICBjb25zdCB7IHggfSA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQuZGF0YXNldDtcblxuICAgIHJldHVybiBbeCwgeV07XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICByZW5kZXJFeGlzdGluZ0JvYXRzLFxuICAgIGdldEJveERPTSxcbiAgICBnZXRYYW5kWSxcbiAgICBjaGFuZ2VBbGxCb3hlc09mU2hpcCxcbiAgICBnZXRCb3hET01zU2hpcEluZGV4LFxuICAgIGNoYW5nZUJveENvbG91cixcbiAgICB0b2dnbGVIb3ZlcmluZyxcbiAgfTtcbn0pKCk7XG4iLCJpbXBvcnQgR2FtZWJvYXJkIGZyb20gXCIuL2dhbWVib2FyZFwiO1xuaW1wb3J0IFVJY29udHJvbGxlciBmcm9tIFwiLi9VSWNvbnRyb2xsZXJcIjtcbmltcG9ydCBlbmVteVBsYXllciBmcm9tIFwiLi9jb21wdXRlclBsYXllclwiO1xuLy8gaW1wb3J0IGVuZW15UGxheWVyIGZyb20gXCIuL2NvbXB1dGVyUGxheWVyXCI7XG5cbi8vIGNvbnN0IHRlc3QgPSBnZXRCb3hET00oXCJlbmVteUFyZWFcIiwgMCwgMCk7XG5cbmNvbnN0IGdhbWVMb29wID0gKCkgPT4ge1xuICAvLyBbNCwgNCwgNCwgNCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gIC8vIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgLy8gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAvLyBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gIC8vIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgLy8gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAvLyBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gIC8vIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgLy8gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAvLyBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG5cbiAgY29uc3Qgc2V0VXBQbGFjZW1lbnRzID0gKGdhbWVib2FyZDEsIGdhbWVib2FyZDIpID0+IHtcbiAgICAvLyBnYW1lYm9hcmQxLnBsYWNlU2hpcCgzLCA2LCAwLCB0cnVlKTtcbiAgICAvLyBnYW1lYm9hcmQxLnBsYWNlU2hpcCgzLCAwLCAxLCB0cnVlKTtcbiAgICAvLyBnYW1lYm9hcmQxLnBsYWNlU2hpcCgyLCAwLCAzLCB0cnVlKTtcbiAgICAvLyBnYW1lYm9hcmQxLnBsYWNlU2hpcCgyLCAwLCA1LCB0cnVlKTtcbiAgICAvLyBnYW1lYm9hcmQxLnBsYWNlU2hpcCgyLCA5LCA2LCBmYWxzZSk7XG4gICAgLy8gZ2FtZWJvYXJkMS5wbGFjZVNoaXAoMSwgMiwgNywgdHJ1ZSk7XG4gICAgLy8gZ2FtZWJvYXJkMS5wbGFjZVNoaXAoMSwgMywgOCwgdHJ1ZSk7XG4gICAgLy8gZ2FtZWJvYXJkMS5wbGFjZVNoaXAoMSwgNCwgOSwgdHJ1ZSk7XG4gICAgLy8gZ2FtZWJvYXJkMS5wbGFjZVNoaXAoMSwgNywgOSwgdHJ1ZSk7XG4gICAgLy8gLy8gZGVidWdnZXI7XG4gICAgLy8gZ2FtZWJvYXJkMS5wbGFjZVNoaXAoNCwgMCwgMCwgdHJ1ZSk7XG4gICAgLy8gY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICBnYW1lYm9hcmQxLnBsYWNlU2hpcFJhbmRvbWx5KDQpO1xuICAgIGdhbWVib2FyZDEucGxhY2VTaGlwUmFuZG9tbHkoMyk7XG4gICAgZ2FtZWJvYXJkMS5wbGFjZVNoaXBSYW5kb21seSgzKTtcbiAgICBnYW1lYm9hcmQxLnBsYWNlU2hpcFJhbmRvbWx5KDIpO1xuICAgIGdhbWVib2FyZDEucGxhY2VTaGlwUmFuZG9tbHkoMik7XG4gICAgZ2FtZWJvYXJkMS5wbGFjZVNoaXBSYW5kb21seSgyKTtcbiAgICBnYW1lYm9hcmQxLnBsYWNlU2hpcFJhbmRvbWx5KDEpO1xuICAgIGdhbWVib2FyZDEucGxhY2VTaGlwUmFuZG9tbHkoMSk7XG4gICAgZ2FtZWJvYXJkMS5wbGFjZVNoaXBSYW5kb21seSgxKTtcbiAgICBnYW1lYm9hcmQxLnBsYWNlU2hpcFJhbmRvbWx5KDEpO1xuXG4gICAgLy8gZ2FtZWJvYXJkMS5wbGFjZVNoaXBSYW5kb21seSg0KTtcbiAgICAvLyBnYW1lYm9hcmQxLnBsYWNlU2hpcFJhbmRvbWx5KDMpO1xuICAgIC8vIGdhbWVib2FyZDEucGxhY2VTaGlwUmFuZG9tbHkoMyk7XG4gICAgLy8gZ2FtZWJvYXJkMS5wbGFjZVNoaXBSYW5kb21seSgyKTtcbiAgICAvLyBnYW1lYm9hcmQxLnBsYWNlU2hpcFJhbmRvbWx5KDIpO1xuICAgIC8vIGdhbWVib2FyZDEucGxhY2VTaGlwUmFuZG9tbHkoMik7XG4gICAgLy8gZ2FtZWJvYXJkMS5wbGFjZVNoaXBSYW5kb21seSgxKTtcbiAgICAvLyBnYW1lYm9hcmQxLnBsYWNlU2hpcFJhbmRvbWx5KDEpO1xuICAgIC8vIGdhbWVib2FyZDEucGxhY2VTaGlwUmFuZG9tbHkoMSk7XG4gICAgLy8gZ2FtZWJvYXJkMS5wbGFjZVNoaXBSYW5kb21seSgxKTtcbiAgICAvLyBkZWJ1Z2dlcjtcbiAgICBnYW1lYm9hcmQyLnBsYWNlU2hpcFJhbmRvbWx5KDQpO1xuICAgIGdhbWVib2FyZDIucGxhY2VTaGlwUmFuZG9tbHkoMyk7XG4gICAgZ2FtZWJvYXJkMi5wbGFjZVNoaXBSYW5kb21seSgzKTtcbiAgICBnYW1lYm9hcmQyLnBsYWNlU2hpcFJhbmRvbWx5KDIpO1xuICAgIGdhbWVib2FyZDIucGxhY2VTaGlwUmFuZG9tbHkoMik7XG4gICAgZ2FtZWJvYXJkMi5wbGFjZVNoaXBSYW5kb21seSgyKTtcbiAgICBnYW1lYm9hcmQyLnBsYWNlU2hpcFJhbmRvbWx5KDEpO1xuICAgIGdhbWVib2FyZDIucGxhY2VTaGlwUmFuZG9tbHkoMSk7XG4gICAgZ2FtZWJvYXJkMi5wbGFjZVNoaXBSYW5kb21seSgxKTtcbiAgICBnYW1lYm9hcmQyLnBsYWNlU2hpcFJhbmRvbWx5KDEpO1xuXG4gICAgLy8gY29uc3QgcmVzdWx0ID0gZ2FtZWJvYXJkMS5wbGFjZVNoaXAoMSwgMCwgMCwgdHJ1ZSk7XG4gICAgLy8gY29uc29sZS5sb2cocmVzdWx0KTtcblxuICAgIC8vIGdhbWVib2FyZDIucGxhY2VTaGlwKDQsIDAsIDAsIHRydWUpO1xuICAgIC8vIGdhbWVib2FyZDIucGxhY2VTaGlwKDMsIDYsIDAsIHRydWUpO1xuICAgIC8vIGdhbWVib2FyZDIucGxhY2VTaGlwKDMsIDAsIDEsIHRydWUpO1xuICAgIC8vIGdhbWVib2FyZDIucGxhY2VTaGlwKDIsIDAsIDMsIHRydWUpO1xuICAgIC8vIGdhbWVib2FyZDIucGxhY2VTaGlwKDIsIDAsIDUsIHRydWUpO1xuICAgIC8vIGdhbWVib2FyZDIucGxhY2VTaGlwKDIsIDksIDYsIGZhbHNlKTtcbiAgICAvLyBnYW1lYm9hcmQyLnBsYWNlU2hpcCgxLCAyLCA3LCB0cnVlKTtcbiAgICAvLyBnYW1lYm9hcmQyLnBsYWNlU2hpcCgxLCAzLCA4LCB0cnVlKTtcbiAgICAvLyBnYW1lYm9hcmQyLnBsYWNlU2hpcCgxLCA0LCA5LCB0cnVlKTtcbiAgICAvLyBnYW1lYm9hcmQyLnBsYWNlU2hpcCgxLCA3LCA5LCB0cnVlKTtcbiAgfTtcblxuICAvLyAgIGRlYnVnZ2VyO1xuXG4gIC8vICAgd2hpbGUgKCFnYW1lT3Zlcikge1xuICBjb25zdCBwbGF5ZXJHYW1lYm9hcmQgPSBHYW1lYm9hcmQoKTtcbiAgY29uc3QgZW5lbXlHYW1lYm9hcmQgPSBHYW1lYm9hcmQoKTtcbiAgc2V0VXBQbGFjZW1lbnRzKHBsYXllckdhbWVib2FyZCwgZW5lbXlHYW1lYm9hcmQpO1xuICBsZXQgZ2FtZU9LID0gdHJ1ZTtcblxuICBVSWNvbnRyb2xsZXIucmVuZGVyRXhpc3RpbmdCb2F0cyhwbGF5ZXJHYW1lYm9hcmQsIFwicGxheWVyQXJlYVwiKTtcbiAgLy8gICBVSWNvbnRyb2xsZXIuZW5lbXlCb3hET01MaXN0ZW5lcihlbmVteUdhbWVib2FyZCk7XG4gIC8vICAgY29uc29sZS5sb2coXCJoYXBwZW5zXCIpO1xuXG4gIGNvbnN0IGhhbmRsZVBsYXllckNsaWNrID0gKGUpID0+IHtcbiAgICBjb25zdCBib3hEb20gPSBlLnRhcmdldDtcbiAgICBjb25zdCBbeCwgeV0gPSBVSWNvbnRyb2xsZXIuZ2V0WGFuZFkoZSk7XG4gICAgY29uc3Qgc2hpcEluZGV4ID0gVUljb250cm9sbGVyLmdldEJveERPTXNTaGlwSW5kZXgoZW5lbXlHYW1lYm9hcmQsIHgsIHkpO1xuICAgIC8vIGNvbnNvbGUubG9nKFwiZXZhbHVhdGluZ1wiLCBib3hEb20uZGF0YXNldC5oaXQpO1xuXG4gICAgaWYgKCFib3hEb20uZGF0YXNldC5oaXQpIHtcbiAgICAgIGJveERvbS5kYXRhc2V0LmhpdCA9IHRydWU7XG4gICAgICBybXZFdmVudExpc3RlbmVyQW5kRW5lbXlUdXJuKCk7XG4gICAgICAvLyAgIGNvbnNvbGUubG9nKFwiYm9vbVwiKTtcbiAgICAgIGNvbnN0IGF0dGFja1Jlc3VsdCA9IGVuZW15R2FtZWJvYXJkLnJlY2VpdmVBdHRhY2soeCwgeSk7XG4gICAgICAvLyAgIGNvbnNvbGUubG9nKFwiYXR0YWNrUmVzdWx0XCIsIGF0dGFja1Jlc3VsdCk7XG4gICAgICBpZiAoYXR0YWNrUmVzdWx0KSB7XG4gICAgICAgIGNvbnN0IHNoaXBPQkogPSBlbmVteUdhbWVib2FyZC5jdXJyZW50U2hpcHNPQkpbc2hpcEluZGV4XTtcbiAgICAgICAgYm94RG9tLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiZ3JleVwiO1xuXG4gICAgICAgIGlmIChzaGlwT0JKLmlzU3VuaygpKSB7XG4gICAgICAgICAgVUljb250cm9sbGVyLmNoYW5nZUFsbEJveGVzT2ZTaGlwKFxuICAgICAgICAgICAgc2hpcEluZGV4LFxuICAgICAgICAgICAgXCJlbmVteUFyZWFcIixcbiAgICAgICAgICAgIGVuZW15R2FtZWJvYXJkXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZW5lbXlHYW1lYm9hcmQuYWxsU2hpcHNTdW5rKCkpIHtcbiAgICAgICAgICBhbGVydChcImdhbWUgT3ZlclwiKTtcbiAgICAgICAgICBnYW1lT0sgPSBmYWxzZTtcbiAgICAgICAgICAvLyAgIHJlbW92aW5nRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYm94RG9tLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmdiKDIwMSwgMjAxLCAxNzgpXCI7XG4gICAgICAgIC8vIHJlbW92aW5nRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgIH1cbiAgICAgIGVuZW15VHVybigpO1xuICAgIH1cblxuICAgIC8vIGNvbnNvbGUubG9nKHNoaXBJbmRleCk7XG4gIH07XG5cbiAgY29uc3QgcGxheWVyc1R1cm4gPSAoKSA9PiB7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLmVuZW15QXJlYSAucm93IC5ib3hgKS5mb3JFYWNoKChhQm94KSA9PiB7XG4gICAgICBhQm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVQbGF5ZXJDbGljaywgeyBvbmNlOiB0cnVlIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IHJtdkV2ZW50TGlzdGVuZXJBbmRFbmVteVR1cm4gPSAoKSA9PiB7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLmVuZW15QXJlYSAucm93IC5ib3hgKS5mb3JFYWNoKChhQm94KSA9PiB7XG4gICAgICBhQm94LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVQbGF5ZXJDbGljayk7XG4gICAgfSk7XG5cbiAgICBVSWNvbnRyb2xsZXIudG9nZ2xlSG92ZXJpbmcoKTtcbiAgfTtcblxuICBjb25zdCBlbmVteUJvdCA9IGVuZW15UGxheWVyKHBsYXllckdhbWVib2FyZCk7XG4gIGNvbnN0IGVuZW15VHVybiA9ICgpID0+IHtcbiAgICBpZiAoIWdhbWVPSykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyAgIGVuZW15J3MgdHVyblxuICAgIC8vICAgY29uc29sZS5sb2coZW5lbXlCb3QpO1xuICAgIGNvbnN0IFtpc0hpdCwgeCwgeV0gPSBlbmVteUJvdC5hdHRhY2soKTtcblxuICAgIGNvbnN0IGJveERPTSA9IFVJY29udHJvbGxlci5nZXRCb3hET00oXCJwbGF5ZXJBcmVhXCIsIHgsIHkpO1xuXG4gICAgaWYgKGlzSGl0KSB7XG4gICAgICBjb25zdCBlbmVteVNoaXBJbmRleCA9IFVJY29udHJvbGxlci5nZXRCb3hET01zU2hpcEluZGV4KFxuICAgICAgICBwbGF5ZXJHYW1lYm9hcmQsXG4gICAgICAgIHgsXG4gICAgICAgIHlcbiAgICAgICk7XG4gICAgICBjb25zdCBzaGlwT0JKID0gcGxheWVyR2FtZWJvYXJkLmN1cnJlbnRTaGlwc09CSltlbmVteVNoaXBJbmRleF07XG5cbiAgICAgIGJveERPTS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInBpbmtcIjtcbiAgICAgIHBsYXllcnNUdXJuKCk7XG4gICAgICBpZiAoc2hpcE9CSi5pc1N1bmsoKSkge1xuICAgICAgICBVSWNvbnRyb2xsZXIuY2hhbmdlQWxsQm94ZXNPZlNoaXAoXG4gICAgICAgICAgZW5lbXlTaGlwSW5kZXgsXG4gICAgICAgICAgXCJwbGF5ZXJBcmVhXCIsXG4gICAgICAgICAgcGxheWVyR2FtZWJvYXJkXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vICAgY29uc29sZS5sb2coYm94RE9NKTtcbiAgICAgIGJveERPTS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInJnYigyMDEsIDIwMSwgMTc4KVwiO1xuICAgICAgcGxheWVyc1R1cm4oKTtcbiAgICB9XG4gIH07XG5cbiAgcGxheWVyc1R1cm4oKTtcbn07XG5cbmdhbWVMb29wKCk7XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBlbmVteVBsYXllcihodW1hbkJvYXJkKSB7XG4gIC8vIG1pbiBpcyBpbmNsdXNpdmUgbWF4IGlzIGV4Y2x1c2l2ZVxuXG4gIGNvbnN0IG1vdmVzRG9uZSA9IFtdO1xuICBjb25zb2xlLmxvZyhtb3Zlc0RvbmUpO1xuICBjb25zdCBnZXRSYW5kb21Db29yZCA9ICgpID0+IHtcbiAgICBjb25zdCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIGNvbnN0IHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgY29uc3QgZm91bmRFbGVtZW50ID0gbW92ZXNEb25lLmZpbmQoXG4gICAgICAoZWxlbWVudCkgPT4gZWxlbWVudFswXSA9PT0geCAmJiBlbGVtZW50WzFdID09PSB5XG4gICAgKTtcblxuICAgIGlmIChmb3VuZEVsZW1lbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGdldFJhbmRvbUNvb3JkKCk7XG4gICAgfVxuICAgIHJldHVybiBbeCwgeV07XG4gIH07XG5cbiAgY29uc3QgYXR0YWNrID0gKCkgPT4ge1xuICAgIGNvbnN0IFt4LCB5XSA9IGdldFJhbmRvbUNvb3JkKCk7XG4gICAgY29uc29sZS5sb2coXCJyYW5kb20gY29vcmRcIiwgeCwgeSk7XG5cbiAgICBjb25zdCBpc0hpdCA9IGh1bWFuQm9hcmQucmVjZWl2ZUF0dGFjayh4LCB5KTtcbiAgICBtb3Zlc0RvbmUucHVzaChbeCwgeV0pO1xuICAgIHJldHVybiBbaXNIaXQsIHgsIHldO1xuICB9O1xuXG4gIHJldHVybiB7IGF0dGFjayB9O1xufVxuIl0sIm5hbWVzIjpbIlNoaXAiLCJsZW5ndGgiLCJfaGl0cyIsIl9sZW5ndGgiLCJpc1N1bmsiLCJoaXQiLCJwbGFjZWQiLCJjb29yZGluYXRlcyIsIkdhbWVib2FyZCIsImdhbWVBcmVuYSIsImN1cnJlbnRTaGlwc09CSiIsIl9wbGFjZWRTaGlwcyIsInNoaXBOdW1iZXJSdWxlc1Bhc3NlZCIsImxlbmd0aE9jY2N1cmVkIiwidGFyZ2V0TGVuZ3RoIiwiaSIsIl9vY2N1cmFuY2VzIiwicGxhY2VTaGlwUmFuZG9tbHkiLCJ4IiwieSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImhvcml6b250YWxseSIsInBsYWNlU2hpcCIsImUiLCJFcnJvciIsImNvbnNvbGUiLCJlcnJvciIsImNoZWNrZWRDb29yZCIsIm5haXZlQ29vciIsInJlc3VsdCIsIm5ld1giLCJwdXNoIiwibmV3WSIsImFsbG93ZWQiLCJmb3JFYWNoIiwiY29vcmRpbmF0ZSIsImFuWCIsImFuWSIsImNoZWNrRm9yT3ZlcmxhcCIsImNoZWNrQ29vcmQiLCJzaGlwT0JKSW5kZXgiLCJpbmRleCIsIm5ld1NoaXBJbmRleCIsImFDb29yZGluYXRlIiwibmV3eCIsIm5ld3kiLCJtaXNzZWRTaG90cyIsImxvZyIsInJlY2VpdmVBdHRhY2siLCJhbGxTaGlwc1N1bmsiLCJjb3VudGVyIiwiZ2V0Qm94RE9NIiwiYXJlYSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInJlbmRlckV4aXN0aW5nQm9hdHMiLCJwbGF5ZXJBcmVhRE9NIiwidXBkYXRlRWFjaERPTUNvb3JkaW5hdGUiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsImFTaGlwIiwiZ2V0WGFuZFkiLCJ0YXJnZXQiLCJkYXRhc2V0IiwicGFyZW50RWxlbWVudCIsImNoYW5nZUFsbEJveGVzT2ZTaGlwIiwic2hpcEluZGV4IiwiYXJlYUNsYXNzIiwiYUNvb3JkIiwic2hpcFgiLCJzaGlwWSIsImdldEJveERPTXNTaGlwSW5kZXgiLCJjaGFuZ2VCb3hDb2xvdXIiLCJjb2xvdXIiLCJ0b2dnbGVIb3ZlcmluZyIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInBsYXllckdhbWVib2FyZCIsImVuZW15R2FtZWJvYXJkIiwiZ2FtZWJvYXJkMSIsImdhbWVib2FyZDIiLCJnYW1lT0siLCJVSWNvbnRyb2xsZXIiLCJoYW5kbGVQbGF5ZXJDbGljayIsImJveERvbSIsInJtdkV2ZW50TGlzdGVuZXJBbmRFbmVteVR1cm4iLCJzaGlwT0JKIiwiYWxlcnQiLCJlbmVteVR1cm4iLCJwbGF5ZXJzVHVybiIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhQm94IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uY2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZW5lbXlCb3QiLCJodW1hbkJvYXJkIiwibW92ZXNEb25lIiwiZ2V0UmFuZG9tQ29vcmQiLCJ1bmRlZmluZWQiLCJmaW5kIiwiZWxlbWVudCIsImF0dGFjayIsImlzSGl0IiwiZW5lbXlQbGF5ZXIiLCJib3hET00iLCJlbmVteVNoaXBJbmRleCIsImdhbWVMb29wIl0sInNvdXJjZVJvb3QiOiIifQ==