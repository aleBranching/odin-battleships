(()=>{"use strict";function e(e){let o=0;const t=e;return{isSunk:()=>o>=t,hit:()=>{o+=1},_length:t,placed:!1,coordinates:void 0}}function o(){const o=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],t=[null,e(4),e(3),e(3),e(2),e(2),e(2),e(1),e(1),e(1),e(1)],r=[],n=e=>{let o=0;return(t=>{for(let t=0;t<r.length;t++)r[t]===e&&o++})(),o<{1:4,2:3,3:2,4:1}[e]},c=[];return{placeShip:(e,c,a,l)=>{if(c<0||a<0||c>10||a>10)throw new Error((e=>{console.error("can't place ship here or no more of these ships or ship too big")}));if(!n)throw new Error((e=>{console.error("can't put anymore of these ships")}));let s;if((()=>{const t=(()=>{const o=[];if(l){if(l){let t=c;for(let r=0;r<e;r++)if(o.push([t,a]),t++,t>10)throw new Error("Boat out of game!")}}else{let t=a;for(let r=0;r<e;r++)if(o.push([c,t]),t++,t>10)throw new Error("boat out of game!")}return o})();return!!(()=>{let e=!0;return t.forEach((t=>{const r=t[0],n=t[1];0!==o[n][r]&&(e=!1)})),e})()&&(s=[...t],!0)})()&&n(e)){const n=(e=>{let o;for(let r=0;r<=10;r++)if(null!=t[r]&&t[r]._length===e&&!1===t[r].placed){o=r;break}return o})(e);t[n].placed=!0,r.push(e),t[n].coordinates=s,s.forEach((e=>{const t=e[0],r=e[1];o[r][t]=n}))}},gameArena:o,receiveAttack:(e,r)=>{if(0!==o[r][e]){const n=o[r][e];return t[n].hit(),!0}return c.push([e,r]),!1},allShipsSunk:()=>{let e=0;for(let o=1;o<11;o++)t[o].isSunk()&&e++;return e>=10},missedShots:c,currentShipsOBJ:t}}const t=function(){const e=(e,o,t)=>document.querySelector(`.${e} .row[data-x="${o}"] .box[data-y="${t}"]`);return{renderExistingBoats:(o,t)=>{const r=([o,r])=>{e(t,o,r).style.backgroundColor="grey"};o.currentShipsOBJ.forEach((e=>{null==e||e.coordinates.forEach(r)}))},getBoxDOM:e,getXandY:e=>{const{y:o}=e.target.dataset,{x:t}=e.target.parentElement.dataset;return[t,o]},changeAllBoxesOfShip:(o,t,r)=>{const{coordinates:n}=r.currentShipsOBJ[o];n.forEach((o=>{const[r,n]=o;e(`${t}`,r,n).style.backgroundColor="red"}))},getBoxDOMsShipIndex:(e,o,t)=>e.gameArena[t][o],changeBoxColour:(o,t,r,n)=>{e(o,t,r).style.backgroundColor=n},toggleHovering:()=>{document.querySelector(".enemyArea").classList.toggle("hovering")}}}();console.log("test"),console.log("change"),(()=>{const e=o(),r=o();var n,c;c=r,(n=e).placeShip(4,0,0,!0),n.placeShip(3,6,0,!0),n.placeShip(3,0,1,!0),n.placeShip(2,0,3,!0),n.placeShip(2,0,5,!0),n.placeShip(2,9,6,!1),n.placeShip(1,2,7,!0),n.placeShip(1,3,8,!0),n.placeShip(1,4,9,!0),n.placeShip(1,7,9,!0),c.placeShip(4,0,0,!0),c.placeShip(3,6,0,!0),c.placeShip(3,0,1,!0),c.placeShip(2,0,3,!0),c.placeShip(2,0,5,!0),c.placeShip(2,9,6,!1),c.placeShip(1,2,7,!0),c.placeShip(1,3,8,!0),c.placeShip(1,4,9,!0),c.placeShip(1,7,9,!0);let a=!0;t.renderExistingBoats(e,"playerArea");const l=e=>{const o=e.target,[n,c]=t.getXandY(e),l=t.getBoxDOMsShipIndex(r,n,c);if(console.log("evaluating",o.dataset.hit),!o.dataset.hit){o.dataset.hit=!0,i();const e=r.receiveAttack(n,c);if(console.log("attackResult",e),e){const e=r.currentShipsOBJ[l];o.style.backgroundColor="grey",e.isSunk()&&t.changeAllBoxesOfShip(l,"enemyArea",r),r.allShipsSunk()&&(alert("game Over"),a=!1)}else o.style.backgroundColor="rgb(190, 146, 154)";h()}console.log(l)},s=()=>{document.querySelectorAll(".enemyArea .row .box").forEach((e=>{e.addEventListener("click",l,{once:!0})}))},i=()=>{document.querySelectorAll(".enemyArea .row .box").forEach((e=>{e.removeEventListener("click",l)})),t.toggleHovering()},h=()=>{if(!a)return;const o=function(e){const o=[],t=()=>{const e=Math.floor(9*Math.random()),r=Math.floor(9*Math.random());return o.includes([e,r])&&t(),[e,r]};return{attack:()=>{const[r,n]=t();console.log("random coord",r,n);const c=e.receiveAttack(r,n);return o.push([r,n]),[c,r,n]},movesDone:o}}(e),[r,n,c]=o.attack(),l=t.getBoxDOM("playerArea",n,c);if(r){const o=t.getBoxDOMsShipIndex(e,n,c),r=e.currentShipsOBJ[o];l.style.backgroundColor="pink",s(),r.isSunk()&&t.changeAllBoxesOfShip(o,"playerArea",e)}else console.log(l),l.style.backgroundColor="rgb(190, 146, 154)",s()};s()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBTW1GLEVBQVFSLEVBQVdsRCxjQUFjMUIsRUFBR0MsR0FFMUMsT0FEQTRFLEVBQVVsRSxLQUFLLENBQUNYLEVBQUdDLElBQ1osQ0FBQ21GLEVBQU9wRixFQUFHQyxFQUFFLEVBR0w0RSxZQUNuQixDRDRGcUJRLENBQVk3QixJQUV0QjRCLEVBQU9wRixFQUFHQyxHQUFLMEUsRUFBU1EsU0FFekJHLEVBQVN6QixFQUFhaEMsVUFBVSxhQUFjN0IsRUFBR0MsR0FFdkQsR0FBSW1GLEVBQU8sQ0FDVCxNQUFNRyxFQUFpQjFCLEVBQWFaLG9CQUNsQ08sRUFDQXhELEVBQ0FDLEdBRUlpRSxFQUFVVixFQUFnQmpFLGdCQUFnQmdHLEdBRWhERCxFQUFPbEQsTUFBTUMsZ0JBQWtCLE9BQy9CZ0MsSUFDSUgsRUFBUWpGLFVBQ1Y0RSxFQUFhbEIscUJBQ1g0QyxFQUNBLGFBQ0EvQixFQUdOLE1BQ0VuRCxRQUFRa0QsSUFBSStCLEdBQ1pBLEVBQU9sRCxNQUFNQyxnQkFBa0IscUJBQy9CZ0MsR0FDRixFQUdGQSxHQUFhLEVBR2ZtQixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwcy8uL3NyYy9sb2dpYy9zaGlwLmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcHMvLi9zcmMvbG9naWMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcHMvLi9zcmMvbG9naWMvVUljb250cm9sbGVyLmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcHMvLi9zcmMvbG9naWMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwcy8uL3NyYy9sb2dpYy9jb21wdXRlclBsYXllci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBTaGlwKGxlbmd0aCkge1xuICBsZXQgX2hpdHMgPSAwO1xuICBjb25zdCBfbGVuZ3RoID0gbGVuZ3RoO1xuICBjb25zdCBwbGFjZWQgPSBmYWxzZTtcbiAgbGV0IGNvb3JkaW5hdGVzO1xuXG4gIGNvbnN0IGhpdCA9ICgpID0+IHtcbiAgICBfaGl0cyArPSAxO1xuICB9O1xuXG4gIGNvbnN0IGlzU3VuayA9ICgpID0+IF9oaXRzID49IF9sZW5ndGg7XG5cbiAgLy8gICB0aGlzLmxlbmd0aCA9IGxlbmd0aDtcblxuICAvLyAgIHRoaXMuX3N1bmsgPSBmYWxzZTtcbiAgLy8gICB0aGlzLl9oaXRzID0gMDtcblxuICAvLyAgIGZ1bmN0aW9uIGhpdCgpIHtcbiAgLy8gICAgIHRoaXMuX2hpdHMgPSArMTtcbiAgLy8gICAgIC8vXG4gIC8vICAgfVxuXG4gIC8vICAgZnVuY3Rpb24gaXNTdW5rKCkge1xuICAvLyAgICAgcmV0dXJuIHRoaXMuX2hpdHMgPj0gbGVuZ3RoID8gdHJ1ZSA6IGZhbHNlO1xuICAvLyAgICAgLy9cbiAgLy8gICB9XG5cbiAgcmV0dXJuIHsgaXNTdW5rLCBoaXQsIF9sZW5ndGgsIHBsYWNlZCwgY29vcmRpbmF0ZXMgfTtcbn1cbiIsImltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gR2FtZWJvYXJkKCkge1xuICAvLyBlYWNoIG51bWJlciBjb3JyZXNwb25kcyB0byBpbmRleCBvZiBjdXJyZW50U2hpcHNPQkpcbiAgY29uc3QgZ2FtZUFyZW5hID0gW1xuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gICAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gICAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gICAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgXTtcblxuICBjb25zdCBjdXJyZW50U2hpcHNPQkogPSBbXG4gICAgbnVsbCxcbiAgICBTaGlwKDQpLFxuICAgIFNoaXAoMyksXG4gICAgU2hpcCgzKSxcbiAgICBTaGlwKDIpLFxuICAgIFNoaXAoMiksXG4gICAgU2hpcCgyKSxcbiAgICBTaGlwKDEpLFxuICAgIFNoaXAoMSksXG4gICAgU2hpcCgxKSxcbiAgICBTaGlwKDEpLFxuICBdO1xuXG4gIGNvbnN0IG5ld1NoaXBJbmRleCA9IChsZW5ndGgpID0+IHtcbiAgICBsZXQgaW5kZXg7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gMTA7IGkrKykge1xuICAgICAgLy8gY29uc29sZS5sb2coXCJUSElTXCIsIGN1cnJlbnRTaGlwc09CSltpXS5fbGVuZ3RoKTtcbiAgICAgIGlmIChjdXJyZW50U2hpcHNPQkpbaV0gPT0gbnVsbCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmIChcbiAgICAgICAgY3VycmVudFNoaXBzT0JKW2ldLl9sZW5ndGggPT09IGxlbmd0aCAmJlxuICAgICAgICBjdXJyZW50U2hpcHNPQkpbaV0ucGxhY2VkID09PSBmYWxzZVxuICAgICAgKSB7XG4gICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpbmRleDtcbiAgfTtcblxuICBjb25zdCBfcGxhY2VkU2hpcHMgPSBbXTtcblxuICBjb25zdCBzaGlwTnVtYmVyUnVsZXNQYXNzZWQgPSAobGVuZ3RoKSA9PiB7XG4gICAgY29uc3QgX2FsbG93ZWRPY2N1cmFuY2VzID0ge1xuICAgICAgMTogNCxcbiAgICAgIDI6IDMsXG4gICAgICAzOiAyLFxuICAgICAgNDogMSxcbiAgICB9O1xuICAgIGxldCBsZW5ndGhPY2NjdXJlZCA9IDA7XG4gICAgY29uc3QgX29jY3VyYW5jZXMgPSAodGFyZ2V0TGVuZ3RoKSA9PiB7XG4gICAgICAvLyBsZXQgY291bnRlciA9IDA7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgX3BsYWNlZFNoaXBzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChfcGxhY2VkU2hpcHNbaV0gPT09IGxlbmd0aCkge1xuICAgICAgICAgIGxlbmd0aE9jY2N1cmVkKys7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIF9vY2N1cmFuY2VzKCk7XG5cbiAgICBpZiAobGVuZ3RoT2NjY3VyZWQgPCBfYWxsb3dlZE9jY3VyYW5jZXNbbGVuZ3RoXSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGNvbnN0IHBsYWNlU2hpcCA9IChsZW5ndGgsIHgsIHksIGhvcml6b250YWxseSkgPT4ge1xuICAgIC8vIHRlc3QgdmFsaWRpdHkgb2YgY28tb3JkIG9yIGFtb3VudCBvZiBzaGlwc1xuICAgIGlmICh4IDwgMCB8fCB5IDwgMCB8fCB4ID4gMTAgfHwgeSA+IDEwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoKGUpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICBcImNhbid0IHBsYWNlIHNoaXAgaGVyZSBvciBubyBtb3JlIG9mIHRoZXNlIHNoaXBzIG9yIHNoaXAgdG9vIGJpZ1wiXG4gICAgICAgICk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoIXNoaXBOdW1iZXJSdWxlc1Bhc3NlZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKChlKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJjYW4ndCBwdXQgYW55bW9yZSBvZiB0aGVzZSBzaGlwc1wiKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGxldCBjaGVja2VkQ29vcmQ7XG5cbiAgICBjb25zdCBjaGVja0Nvb3JkID0gKCkgPT4ge1xuICAgICAgLy8gd2hhdCB3b3VsZCB0aGV5IGJlIG5haXZlbHlcblxuICAgICAgY29uc3QgbmFpdmVDb29yID0gKCgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XG5cbiAgICAgICAgaWYgKCFob3Jpem9udGFsbHkpIHtcbiAgICAgICAgICBsZXQgbmV3WSA9IHk7XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goW3gsIG5ld1ldKTtcbiAgICAgICAgICAgIG5ld1krKztcbiAgICAgICAgICAgIGlmIChuZXdZID4gMTApIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9hdCBvdXQgb2YgZ2FtZSFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGhvcml6b250YWxseSkge1xuICAgICAgICAgIGxldCBuZXdYID0geDtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaChbbmV3WCwgeV0pO1xuICAgICAgICAgICAgbmV3WCsrO1xuICAgICAgICAgICAgaWYgKG5ld1ggPiAxMCkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJCb2F0IG91dCBvZiBnYW1lIVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfSkoKTtcblxuICAgICAgY29uc3QgY2hlY2tGb3JPdmVybGFwID0gKCkgPT4ge1xuICAgICAgICBsZXQgYWxsb3dlZCA9IHRydWU7XG5cbiAgICAgICAgbmFpdmVDb29yLmZvckVhY2goKGNvb3JkaW5hdGUpID0+IHtcbiAgICAgICAgICBjb25zdCBhblggPSBjb29yZGluYXRlWzBdO1xuICAgICAgICAgIGNvbnN0IGFuWSA9IGNvb3JkaW5hdGVbMV07XG5cbiAgICAgICAgICAvLyBpbiBnYW1lYXJlbmEgZmlyc3QgaGF2ZSB0byBhY2Nlc3MgWVxuXG4gICAgICAgICAgaWYgKGdhbWVBcmVuYVthblldW2FuWF0gIT09IDApIHtcbiAgICAgICAgICAgIGFsbG93ZWQgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBhbGxvd2VkO1xuICAgICAgfTtcblxuICAgICAgaWYgKGNoZWNrRm9yT3ZlcmxhcCgpKSB7XG4gICAgICAgIGNoZWNrZWRDb29yZCA9IFsuLi5uYWl2ZUNvb3JdO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICAvLyBjb25zb2xlLmxvZyhcIlRISVNcIiwgc2hpcE51bWJlclJ1bGVzUGFzc2VkKGxlbmd0aCkpO1xuICAgIGlmIChjaGVja0Nvb3JkKCkgJiYgc2hpcE51bWJlclJ1bGVzUGFzc2VkKGxlbmd0aCkpIHtcbiAgICAgIGNvbnN0IHNoaXBPQkpJbmRleCA9IG5ld1NoaXBJbmRleChsZW5ndGgpO1xuICAgICAgY3VycmVudFNoaXBzT0JKW3NoaXBPQkpJbmRleF0ucGxhY2VkID0gdHJ1ZTtcbiAgICAgIF9wbGFjZWRTaGlwcy5wdXNoKGxlbmd0aCk7XG5cbiAgICAgIGN1cnJlbnRTaGlwc09CSltzaGlwT0JKSW5kZXhdLmNvb3JkaW5hdGVzID0gY2hlY2tlZENvb3JkO1xuICAgICAgY2hlY2tlZENvb3JkLmZvckVhY2goKGFDb29yZGluYXRlKSA9PiB7XG4gICAgICAgIGNvbnN0IG5ld3ggPSBhQ29vcmRpbmF0ZVswXTtcbiAgICAgICAgY29uc3QgbmV3eSA9IGFDb29yZGluYXRlWzFdO1xuXG4gICAgICAgIGdhbWVBcmVuYVtuZXd5XVtuZXd4XSA9IHNoaXBPQkpJbmRleDtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgbWlzc2VkU2hvdHMgPSBbXTtcblxuICBjb25zdCByZWNlaXZlQXR0YWNrID0gKHgsIHkpID0+IHtcbiAgICBpZiAoZ2FtZUFyZW5hW3ldW3hdICE9PSAwKSB7XG4gICAgICBjb25zdCBzaGlwT0JKSW5kZXggPSBnYW1lQXJlbmFbeV1beF07XG4gICAgICBjdXJyZW50U2hpcHNPQkpbc2hpcE9CSkluZGV4XS5oaXQoKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBtaXNzZWRTaG90cy5wdXNoKFt4LCB5XSk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGNvbnN0IGFsbFNoaXBzU3VuayA9ICgpID0+IHtcbiAgICBsZXQgY291bnRlciA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCAxMTsgaSsrKSB7XG4gICAgICBpZiAoY3VycmVudFNoaXBzT0JKW2ldLmlzU3VuaygpKSB7XG4gICAgICAgIGNvdW50ZXIrKztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGNvdW50ZXIgPj0gMTApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBwbGFjZVNoaXAsXG4gICAgZ2FtZUFyZW5hLFxuICAgIHJlY2VpdmVBdHRhY2ssXG4gICAgYWxsU2hpcHNTdW5rLFxuICAgIG1pc3NlZFNob3RzLFxuICAgIGN1cnJlbnRTaGlwc09CSixcbiAgfTtcbn1cbiIsImltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5cbmV4cG9ydCBkZWZhdWx0IChmdW5jdGlvbiBVSWNvbnRyb2xsZXIoKSB7XG4gIGNvbnN0IGdldEJveERPTSA9IChhcmVhLCB4LCB5KSA9PlxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2FyZWF9IC5yb3dbZGF0YS14PVwiJHt4fVwiXSAuYm94W2RhdGEteT1cIiR7eX1cIl1gKTtcblxuICBjb25zdCByZW5kZXJFeGlzdGluZ0JvYXRzID0gKGdhbWVBcmVuYSwgcGxheWVyQXJlYURPTSkgPT4ge1xuICAgIGNvbnN0IHVwZGF0ZUVhY2hET01Db29yZGluYXRlID0gKFt4LCB5XSkgPT4ge1xuICAgICAgZ2V0Qm94RE9NKHBsYXllckFyZWFET00sIHgsIHkpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiZ3JleVwiO1xuICAgIH07XG5cbiAgICBnYW1lQXJlbmEuY3VycmVudFNoaXBzT0JKLmZvckVhY2goKGFTaGlwKSA9PiB7XG4gICAgICBpZiAoYVNoaXAgPT0gbnVsbCkge1xuICAgICAgICAvLyBudWxsXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhU2hpcC5jb29yZGluYXRlcy5mb3JFYWNoKHVwZGF0ZUVhY2hET01Db29yZGluYXRlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBjaGFuZ2VCb3hDb2xvdXIgPSAoYXJlYSwgeCwgeSwgY29sb3VyKSA9PiB7XG4gICAgY29uc3QgaGl0Qm94RE9NID0gZ2V0Qm94RE9NKGFyZWEsIHgsIHkpO1xuICAgIGhpdEJveERPTS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvdXI7XG4gIH07XG5cbiAgY29uc3QgdG9nZ2xlSG92ZXJpbmcgPSAoKSA9PiB7XG4gICAgY29uc3QgYXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZW5lbXlBcmVhXCIpO1xuICAgIGFyZWEuY2xhc3NMaXN0LnRvZ2dsZShcImhvdmVyaW5nXCIpO1xuICB9O1xuXG4gIGNvbnN0IGdldEJveERPTXNTaGlwSW5kZXggPSAoZ2FtZUFyZW5hLCB4LCB5KSA9PiB7XG4gICAgY29uc3Qgc2hpcEluZGV4ID0gZ2FtZUFyZW5hLmdhbWVBcmVuYVt5XVt4XTtcbiAgICByZXR1cm4gc2hpcEluZGV4O1xuICB9O1xuXG4gIGNvbnN0IGNoYW5nZUFsbEJveGVzT2ZTaGlwID0gKHNoaXBJbmRleCwgYXJlYUNsYXNzLCBnYW1lQXJlbmEpID0+IHtcbiAgICBjb25zdCB7IGNvb3JkaW5hdGVzIH0gPSBnYW1lQXJlbmEuY3VycmVudFNoaXBzT0JKW3NoaXBJbmRleF07XG4gICAgY29vcmRpbmF0ZXMuZm9yRWFjaCgoYUNvb3JkKSA9PiB7XG4gICAgICBjb25zdCBbc2hpcFgsIHNoaXBZXSA9IGFDb29yZDtcbiAgICAgIGdldEJveERPTShgJHthcmVhQ2xhc3N9YCwgc2hpcFgsIHNoaXBZKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInJlZFwiO1xuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGdldFhhbmRZID0gKGUpID0+IHtcbiAgICBjb25zdCB7IHkgfSA9IGUudGFyZ2V0LmRhdGFzZXQ7XG4gICAgY29uc3QgeyB4IH0gPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LmRhdGFzZXQ7XG5cbiAgICByZXR1cm4gW3gsIHldO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgcmVuZGVyRXhpc3RpbmdCb2F0cyxcbiAgICBnZXRCb3hET00sXG4gICAgZ2V0WGFuZFksXG4gICAgY2hhbmdlQWxsQm94ZXNPZlNoaXAsXG4gICAgZ2V0Qm94RE9Nc1NoaXBJbmRleCxcbiAgICBjaGFuZ2VCb3hDb2xvdXIsXG4gICAgdG9nZ2xlSG92ZXJpbmcsXG4gIH07XG59KSgpO1xuIiwiaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcbmltcG9ydCBVSWNvbnRyb2xsZXIgZnJvbSBcIi4vVUljb250cm9sbGVyXCI7XG5pbXBvcnQgZW5lbXlQbGF5ZXIgZnJvbSBcIi4vY29tcHV0ZXJQbGF5ZXJcIjtcbi8vIGltcG9ydCBlbmVteVBsYXllciBmcm9tIFwiLi9jb21wdXRlclBsYXllclwiO1xuXG5jb25zb2xlLmxvZyhcInRlc3RcIik7XG5jb25zb2xlLmxvZyhcImNoYW5nZVwiKTtcblxuLy8gY29uc3QgdGVzdCA9IGdldEJveERPTShcImVuZW15QXJlYVwiLCAwLCAwKTtcblxuY29uc3QgZ2FtZUxvb3AgPSAoKSA9PiB7XG4gIC8vIFs0LCA0LCA0LCA0LCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgLy8gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAvLyBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gIC8vIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgLy8gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAvLyBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gIC8vIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgLy8gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAvLyBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gIC8vIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcblxuICBjb25zdCBzZXRVcFBsYWNlbWVudHMgPSAoZ2FtZWJvYXJkMSwgZ2FtZWJvYXJkMikgPT4ge1xuICAgIGdhbWVib2FyZDEucGxhY2VTaGlwKDQsIDAsIDAsIHRydWUpO1xuICAgIGdhbWVib2FyZDEucGxhY2VTaGlwKDMsIDYsIDAsIHRydWUpO1xuICAgIGdhbWVib2FyZDEucGxhY2VTaGlwKDMsIDAsIDEsIHRydWUpO1xuICAgIGdhbWVib2FyZDEucGxhY2VTaGlwKDIsIDAsIDMsIHRydWUpO1xuICAgIGdhbWVib2FyZDEucGxhY2VTaGlwKDIsIDAsIDUsIHRydWUpO1xuICAgIGdhbWVib2FyZDEucGxhY2VTaGlwKDIsIDksIDYsIGZhbHNlKTtcbiAgICBnYW1lYm9hcmQxLnBsYWNlU2hpcCgxLCAyLCA3LCB0cnVlKTtcbiAgICBnYW1lYm9hcmQxLnBsYWNlU2hpcCgxLCAzLCA4LCB0cnVlKTtcbiAgICBnYW1lYm9hcmQxLnBsYWNlU2hpcCgxLCA0LCA5LCB0cnVlKTtcbiAgICBnYW1lYm9hcmQxLnBsYWNlU2hpcCgxLCA3LCA5LCB0cnVlKTtcblxuICAgIGdhbWVib2FyZDIucGxhY2VTaGlwKDQsIDAsIDAsIHRydWUpO1xuICAgIGdhbWVib2FyZDIucGxhY2VTaGlwKDMsIDYsIDAsIHRydWUpO1xuICAgIGdhbWVib2FyZDIucGxhY2VTaGlwKDMsIDAsIDEsIHRydWUpO1xuICAgIGdhbWVib2FyZDIucGxhY2VTaGlwKDIsIDAsIDMsIHRydWUpO1xuICAgIGdhbWVib2FyZDIucGxhY2VTaGlwKDIsIDAsIDUsIHRydWUpO1xuICAgIGdhbWVib2FyZDIucGxhY2VTaGlwKDIsIDksIDYsIGZhbHNlKTtcbiAgICBnYW1lYm9hcmQyLnBsYWNlU2hpcCgxLCAyLCA3LCB0cnVlKTtcbiAgICBnYW1lYm9hcmQyLnBsYWNlU2hpcCgxLCAzLCA4LCB0cnVlKTtcbiAgICBnYW1lYm9hcmQyLnBsYWNlU2hpcCgxLCA0LCA5LCB0cnVlKTtcbiAgICBnYW1lYm9hcmQyLnBsYWNlU2hpcCgxLCA3LCA5LCB0cnVlKTtcbiAgfTtcblxuICAvLyAgIGRlYnVnZ2VyO1xuXG4gIC8vICAgd2hpbGUgKCFnYW1lT3Zlcikge1xuICBjb25zdCBwbGF5ZXJHYW1lYm9hcmQgPSBHYW1lYm9hcmQoKTtcbiAgY29uc3QgZW5lbXlHYW1lYm9hcmQgPSBHYW1lYm9hcmQoKTtcbiAgc2V0VXBQbGFjZW1lbnRzKHBsYXllckdhbWVib2FyZCwgZW5lbXlHYW1lYm9hcmQpO1xuICBsZXQgZ2FtZU9LID0gdHJ1ZTtcblxuICBVSWNvbnRyb2xsZXIucmVuZGVyRXhpc3RpbmdCb2F0cyhwbGF5ZXJHYW1lYm9hcmQsIFwicGxheWVyQXJlYVwiKTtcbiAgLy8gICBVSWNvbnRyb2xsZXIuZW5lbXlCb3hET01MaXN0ZW5lcihlbmVteUdhbWVib2FyZCk7XG4gIC8vICAgY29uc29sZS5sb2coXCJoYXBwZW5zXCIpO1xuXG4gIGNvbnN0IGhhbmRsZVBsYXllckNsaWNrID0gKGUpID0+IHtcbiAgICBjb25zdCBib3hEb20gPSBlLnRhcmdldDtcbiAgICBjb25zdCBbeCwgeV0gPSBVSWNvbnRyb2xsZXIuZ2V0WGFuZFkoZSk7XG4gICAgY29uc3Qgc2hpcEluZGV4ID0gVUljb250cm9sbGVyLmdldEJveERPTXNTaGlwSW5kZXgoZW5lbXlHYW1lYm9hcmQsIHgsIHkpO1xuICAgIGNvbnNvbGUubG9nKFwiZXZhbHVhdGluZ1wiLCBib3hEb20uZGF0YXNldC5oaXQpO1xuXG4gICAgaWYgKCFib3hEb20uZGF0YXNldC5oaXQpIHtcbiAgICAgIGJveERvbS5kYXRhc2V0LmhpdCA9IHRydWU7XG4gICAgICBybXZFdmVudExpc3RlbmVyQW5kRW5lbXlUdXJuKCk7XG4gICAgICAvLyAgIGNvbnNvbGUubG9nKFwiYm9vbVwiKTtcbiAgICAgIGNvbnN0IGF0dGFja1Jlc3VsdCA9IGVuZW15R2FtZWJvYXJkLnJlY2VpdmVBdHRhY2soeCwgeSk7XG4gICAgICBjb25zb2xlLmxvZyhcImF0dGFja1Jlc3VsdFwiLCBhdHRhY2tSZXN1bHQpO1xuICAgICAgaWYgKGF0dGFja1Jlc3VsdCkge1xuICAgICAgICBjb25zdCBzaGlwT0JKID0gZW5lbXlHYW1lYm9hcmQuY3VycmVudFNoaXBzT0JKW3NoaXBJbmRleF07XG4gICAgICAgIGJveERvbS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcImdyZXlcIjtcblxuICAgICAgICBpZiAoc2hpcE9CSi5pc1N1bmsoKSkge1xuICAgICAgICAgIFVJY29udHJvbGxlci5jaGFuZ2VBbGxCb3hlc09mU2hpcChcbiAgICAgICAgICAgIHNoaXBJbmRleCxcbiAgICAgICAgICAgIFwiZW5lbXlBcmVhXCIsXG4gICAgICAgICAgICBlbmVteUdhbWVib2FyZFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVuZW15R2FtZWJvYXJkLmFsbFNoaXBzU3VuaygpKSB7XG4gICAgICAgICAgYWxlcnQoXCJnYW1lIE92ZXJcIik7XG4gICAgICAgICAgZ2FtZU9LID0gZmFsc2U7XG4gICAgICAgICAgLy8gICByZW1vdmluZ0V2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJveERvbS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInJnYigxOTAsIDE0NiwgMTU0KVwiO1xuICAgICAgICAvLyByZW1vdmluZ0V2ZW50TGlzdGVuZXJzKCk7XG4gICAgICB9XG4gICAgICBlbmVteVR1cm4oKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhzaGlwSW5kZXgpO1xuICB9O1xuXG4gIGNvbnN0IHBsYXllcnNUdXJuID0gKCkgPT4ge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5lbmVteUFyZWEgLnJvdyAuYm94YCkuZm9yRWFjaCgoYUJveCkgPT4ge1xuICAgICAgYUJveC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlUGxheWVyQ2xpY2ssIHsgb25jZTogdHJ1ZSB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBybXZFdmVudExpc3RlbmVyQW5kRW5lbXlUdXJuID0gKCkgPT4ge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5lbmVteUFyZWEgLnJvdyAuYm94YCkuZm9yRWFjaCgoYUJveCkgPT4ge1xuICAgICAgYUJveC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlUGxheWVyQ2xpY2spO1xuICAgIH0pO1xuXG4gICAgVUljb250cm9sbGVyLnRvZ2dsZUhvdmVyaW5nKCk7XG4gIH07XG5cbiAgY29uc3QgZW5lbXlUdXJuID0gKCkgPT4ge1xuICAgIGlmICghZ2FtZU9LKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vICAgZW5lbXkncyB0dXJuXG4gICAgY29uc3QgZW5lbXlCb3QgPSBlbmVteVBsYXllcihwbGF5ZXJHYW1lYm9hcmQpO1xuICAgIC8vICAgY29uc29sZS5sb2coZW5lbXlCb3QpO1xuICAgIGNvbnN0IFtpc0hpdCwgeCwgeV0gPSBlbmVteUJvdC5hdHRhY2soKTtcblxuICAgIGNvbnN0IGJveERPTSA9IFVJY29udHJvbGxlci5nZXRCb3hET00oXCJwbGF5ZXJBcmVhXCIsIHgsIHkpO1xuXG4gICAgaWYgKGlzSGl0KSB7XG4gICAgICBjb25zdCBlbmVteVNoaXBJbmRleCA9IFVJY29udHJvbGxlci5nZXRCb3hET01zU2hpcEluZGV4KFxuICAgICAgICBwbGF5ZXJHYW1lYm9hcmQsXG4gICAgICAgIHgsXG4gICAgICAgIHlcbiAgICAgICk7XG4gICAgICBjb25zdCBzaGlwT0JKID0gcGxheWVyR2FtZWJvYXJkLmN1cnJlbnRTaGlwc09CSltlbmVteVNoaXBJbmRleF07XG5cbiAgICAgIGJveERPTS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInBpbmtcIjtcbiAgICAgIHBsYXllcnNUdXJuKCk7XG4gICAgICBpZiAoc2hpcE9CSi5pc1N1bmsoKSkge1xuICAgICAgICBVSWNvbnRyb2xsZXIuY2hhbmdlQWxsQm94ZXNPZlNoaXAoXG4gICAgICAgICAgZW5lbXlTaGlwSW5kZXgsXG4gICAgICAgICAgXCJwbGF5ZXJBcmVhXCIsXG4gICAgICAgICAgcGxheWVyR2FtZWJvYXJkXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKGJveERPTSk7XG4gICAgICBib3hET00uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJyZ2IoMTkwLCAxNDYsIDE1NClcIjtcbiAgICAgIHBsYXllcnNUdXJuKCk7XG4gICAgfVxuICB9O1xuXG4gIHBsYXllcnNUdXJuKCk7XG59O1xuXG5nYW1lTG9vcCgpO1xuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZW5lbXlQbGF5ZXIoaHVtYW5Cb2FyZCkge1xuICAvLyBtaW4gaXMgaW5jbHVzaXZlIG1heCBpcyBleGNsdXNpdmVcblxuICBjb25zdCBtb3Zlc0RvbmUgPSBbXTtcbiAgY29uc3QgZ2V0UmFuZG9tQ29vcmQgPSAoKSA9PiB7XG4gICAgY29uc3QgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDkpO1xuICAgIGNvbnN0IHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA5KTtcbiAgICBpZiAobW92ZXNEb25lLmluY2x1ZGVzKFt4LCB5XSkpIHtcbiAgICAgIGdldFJhbmRvbUNvb3JkKCk7XG4gICAgfVxuICAgIHJldHVybiBbeCwgeV07XG4gIH07XG5cbiAgY29uc3QgYXR0YWNrID0gKCkgPT4ge1xuICAgIGNvbnN0IFt4LCB5XSA9IGdldFJhbmRvbUNvb3JkKCk7XG4gICAgY29uc29sZS5sb2coXCJyYW5kb20gY29vcmRcIiwgeCwgeSk7XG5cbiAgICBjb25zdCBpc0hpdCA9IGh1bWFuQm9hcmQucmVjZWl2ZUF0dGFjayh4LCB5KTtcbiAgICBtb3Zlc0RvbmUucHVzaChbeCwgeV0pO1xuICAgIHJldHVybiBbaXNIaXQsIHgsIHldO1xuICB9O1xuXG4gIHJldHVybiB7IGF0dGFjaywgbW92ZXNEb25lIH07XG59XG4iXSwibmFtZXMiOlsiU2hpcCIsImxlbmd0aCIsIl9oaXRzIiwiX2xlbmd0aCIsImlzU3VuayIsImhpdCIsInBsYWNlZCIsImNvb3JkaW5hdGVzIiwiR2FtZWJvYXJkIiwiZ2FtZUFyZW5hIiwiY3VycmVudFNoaXBzT0JKIiwiX3BsYWNlZFNoaXBzIiwic2hpcE51bWJlclJ1bGVzUGFzc2VkIiwibGVuZ3RoT2NjY3VyZWQiLCJ0YXJnZXRMZW5ndGgiLCJpIiwiX29jY3VyYW5jZXMiLCJtaXNzZWRTaG90cyIsInBsYWNlU2hpcCIsIngiLCJ5IiwiaG9yaXpvbnRhbGx5IiwiRXJyb3IiLCJlIiwiY29uc29sZSIsImVycm9yIiwiY2hlY2tlZENvb3JkIiwibmFpdmVDb29yIiwicmVzdWx0IiwibmV3WCIsInB1c2giLCJuZXdZIiwiYWxsb3dlZCIsImZvckVhY2giLCJjb29yZGluYXRlIiwiYW5YIiwiYW5ZIiwiY2hlY2tGb3JPdmVybGFwIiwiY2hlY2tDb29yZCIsInNoaXBPQkpJbmRleCIsImluZGV4IiwibmV3U2hpcEluZGV4IiwiYUNvb3JkaW5hdGUiLCJuZXd4IiwibmV3eSIsInJlY2VpdmVBdHRhY2siLCJhbGxTaGlwc1N1bmsiLCJjb3VudGVyIiwiZ2V0Qm94RE9NIiwiYXJlYSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInJlbmRlckV4aXN0aW5nQm9hdHMiLCJwbGF5ZXJBcmVhRE9NIiwidXBkYXRlRWFjaERPTUNvb3JkaW5hdGUiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsImFTaGlwIiwiZ2V0WGFuZFkiLCJ0YXJnZXQiLCJkYXRhc2V0IiwicGFyZW50RWxlbWVudCIsImNoYW5nZUFsbEJveGVzT2ZTaGlwIiwic2hpcEluZGV4IiwiYXJlYUNsYXNzIiwiYUNvb3JkIiwic2hpcFgiLCJzaGlwWSIsImdldEJveERPTXNTaGlwSW5kZXgiLCJjaGFuZ2VCb3hDb2xvdXIiLCJjb2xvdXIiLCJ0b2dnbGVIb3ZlcmluZyIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImxvZyIsInBsYXllckdhbWVib2FyZCIsImVuZW15R2FtZWJvYXJkIiwiZ2FtZWJvYXJkMSIsImdhbWVib2FyZDIiLCJnYW1lT0siLCJVSWNvbnRyb2xsZXIiLCJoYW5kbGVQbGF5ZXJDbGljayIsImJveERvbSIsInJtdkV2ZW50TGlzdGVuZXJBbmRFbmVteVR1cm4iLCJhdHRhY2tSZXN1bHQiLCJzaGlwT0JKIiwiYWxlcnQiLCJlbmVteVR1cm4iLCJwbGF5ZXJzVHVybiIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhQm94IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uY2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZW5lbXlCb3QiLCJodW1hbkJvYXJkIiwibW92ZXNEb25lIiwiZ2V0UmFuZG9tQ29vcmQiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJpbmNsdWRlcyIsImF0dGFjayIsImlzSGl0IiwiZW5lbXlQbGF5ZXIiLCJib3hET00iLCJlbmVteVNoaXBJbmRleCIsImdhbWVMb29wIl0sInNvdXJjZVJvb3QiOiIifQ==