(()=>{"use strict";function e(e){let t=0;const r=e;return{isSunk:()=>t>=r,hit:()=>{t+=1},_length:r,placed:!1,coordinates:void 0}}function t(){const t=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],r=[null,e(4),e(3),e(3),e(2),e(2),e(2),e(1),e(1),e(1),e(1)],o=[],n=e=>{let t=0;return(r=>{for(let r=0;r<o.length;r++)o[r]===e&&t++})(),t<{1:4,2:3,3:2,4:1}[e]},c=[];return{placeShip:(e,c,a,l)=>{if(c<0||a<0||c>10||a>10)throw new Error((e=>{console.error("can't place ship here or no more of these ships or ship too big")}));if(!n)throw new Error((e=>{console.error("can't put anymore of these ships")}));let s;if((()=>{const r=(()=>{const t=[];if(l){if(l){let r=c;for(let o=0;o<e;o++)if(t.push([r,a]),r++,r>10)throw new Error("Boat out of game!")}}else{let r=a;for(let o=0;o<e;o++)if(t.push([c,r]),r++,r>10)throw new Error("boat out of game!")}return t})();return!!(()=>{let e=!0;return r.forEach((r=>{const o=r[0],n=r[1];0!==t[n][o]&&(e=!1)})),e})()&&(s=[...r],!0)})()&&n(e)){const n=(e=>{let t;for(let o=0;o<=10;o++)if(null!=r[o]&&r[o]._length===e&&!1===r[o].placed){t=o;break}return t})(e);r[n].placed=!0,o.push(e),r[n].coordinates=s,s.forEach((e=>{const r=e[0],o=e[1];t[o][r]=n}))}},gameArena:t,receiveAttack:(e,o)=>{if(0!==t[o][e]){const n=t[o][e];return r[n].hit(),!0}return c.push([e,o]),!1},allShipsSunk:()=>{let e=0;for(let t=1;t<11;t++)r[t].isSunk()&&e++;return e>=10},missedShots:c,currentShipsOBJ:r}}const r=function(){const e=(e,t,r)=>document.querySelector(`.${e} .row[data-x="${t}"] .box[data-y="${r}"]`);return{renderExistingBoats:(t,r)=>{const o=([t,o])=>{e(r,t,o).style.backgroundColor="grey"};t.currentShipsOBJ.forEach((e=>{null==e||e.coordinates.forEach(o)}))},getBoxDOM:e,getXandY:e=>{const{y:t}=e.target.dataset,{x:r}=e.target.parentElement.dataset;return[r,t]},changeAllBoxesOfShip:(t,r,o)=>{const{coordinates:n}=o.currentShipsOBJ[t];n.forEach((t=>{const[o,n]=t;e(`${r}`,o,n).style.backgroundColor="red"}))},getBoxDOMsShipIndex:(e,t,r)=>e.gameArena[r][t],changeBoxColour:(t,r,o,n)=>{e(t,r,o).style.backgroundColor=n},toggleHovering:()=>{document.querySelector(".enemyArea").classList.toggle("hovering")}}}();(()=>{const e=t(),o=t();var n,c;c=o,(n=e).placeShip(4,0,0,!0),n.placeShip(3,6,0,!0),n.placeShip(3,0,1,!0),n.placeShip(2,0,3,!0),n.placeShip(2,0,5,!0),n.placeShip(2,9,6,!1),n.placeShip(1,2,7,!0),n.placeShip(1,3,8,!0),n.placeShip(1,4,9,!0),n.placeShip(1,7,9,!0),c.placeShip(4,0,0,!0),c.placeShip(3,6,0,!0),c.placeShip(3,0,1,!0),c.placeShip(2,0,3,!0),c.placeShip(2,0,5,!0),c.placeShip(2,9,6,!1),c.placeShip(1,2,7,!0),c.placeShip(1,3,8,!0),c.placeShip(1,4,9,!0),c.placeShip(1,7,9,!0);let a=!0;r.renderExistingBoats(e,"playerArea");const l=e=>{const t=e.target,[n,c]=r.getXandY(e),l=r.getBoxDOMsShipIndex(o,n,c);if(!t.dataset.hit){if(t.dataset.hit=!0,i(),o.receiveAttack(n,c)){const e=o.currentShipsOBJ[l];t.style.backgroundColor="grey",e.isSunk()&&r.changeAllBoxesOfShip(l,"enemyArea",o),o.allShipsSunk()&&(alert("game Over"),a=!1)}else t.style.backgroundColor="rgb(190, 146, 154)";p()}},s=()=>{document.querySelectorAll(".enemyArea .row .box").forEach((e=>{e.addEventListener("click",l,{once:!0})}))},i=()=>{document.querySelectorAll(".enemyArea .row .box").forEach((e=>{e.removeEventListener("click",l)})),r.toggleHovering()},h=function(e){const t=[];console.log(t);const r=()=>{const e=Math.floor(10*Math.random()),o=Math.floor(10*Math.random());return void 0!==t.find((t=>t[0]===e&&t[1]===o))?r():[e,o]};return{attack:()=>{const[o,n]=r();console.log("random coord",o,n);const c=e.receiveAttack(o,n);return t.push([o,n]),[c,o,n]}}}(e),p=()=>{if(!a)return;const[t,o,n]=h.attack(),c=r.getBoxDOM("playerArea",o,n);if(t){const t=r.getBoxDOMsShipIndex(e,o,n),a=e.currentShipsOBJ[t];c.style.backgroundColor="pink",s(),a.isSunk()&&r.changeAllBoxesOfShip(t,"playerArea",e)}else c.style.backgroundColor="rgb(190, 146, 154)",s()};s()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WS9CLEdBQ3ZCVyxFQUFZLEtBQ2hCLElBQUtQLEVBQ0gsT0FJRixNQUFPMEIsRUFBT3JGLEVBQUdDLEdBQUt3RSxFQUFTVyxTQUV6QkcsRUFBUzNCLEVBQWEvQixVQUFVLGFBQWM3QixFQUFHQyxHQUV2RCxHQUFJb0YsRUFBTyxDQUNULE1BQU1HLEVBQWlCNUIsRUFBYVgsb0JBQ2xDTSxFQUNBdkQsRUFDQUMsR0FFSStELEVBQVVULEVBQWdCaEUsZ0JBQWdCaUcsR0FFaERELEVBQU9uRCxNQUFNQyxnQkFBa0IsT0FDL0I4QixJQUNJSCxFQUFRL0UsVUFDVjJFLEVBQWFqQixxQkFDWDZDLEVBQ0EsYUFDQWpDLEVBR04sTUFFRWdDLEVBQU9uRCxNQUFNQyxnQkFBa0IscUJBQy9COEIsR0FDRixFQUdGQSxHQUFhLEVBR2ZzQixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwcy8uL3NyYy9sb2dpYy9zaGlwLmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcHMvLi9zcmMvbG9naWMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcHMvLi9zcmMvbG9naWMvVUljb250cm9sbGVyLmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcHMvLi9zcmMvbG9naWMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwcy8uL3NyYy9sb2dpYy9jb21wdXRlclBsYXllci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBTaGlwKGxlbmd0aCkge1xuICBsZXQgX2hpdHMgPSAwO1xuICBjb25zdCBfbGVuZ3RoID0gbGVuZ3RoO1xuICBjb25zdCBwbGFjZWQgPSBmYWxzZTtcbiAgbGV0IGNvb3JkaW5hdGVzO1xuXG4gIGNvbnN0IGhpdCA9ICgpID0+IHtcbiAgICBfaGl0cyArPSAxO1xuICB9O1xuXG4gIGNvbnN0IGlzU3VuayA9ICgpID0+IF9oaXRzID49IF9sZW5ndGg7XG5cbiAgLy8gICB0aGlzLmxlbmd0aCA9IGxlbmd0aDtcblxuICAvLyAgIHRoaXMuX3N1bmsgPSBmYWxzZTtcbiAgLy8gICB0aGlzLl9oaXRzID0gMDtcblxuICAvLyAgIGZ1bmN0aW9uIGhpdCgpIHtcbiAgLy8gICAgIHRoaXMuX2hpdHMgPSArMTtcbiAgLy8gICAgIC8vXG4gIC8vICAgfVxuXG4gIC8vICAgZnVuY3Rpb24gaXNTdW5rKCkge1xuICAvLyAgICAgcmV0dXJuIHRoaXMuX2hpdHMgPj0gbGVuZ3RoID8gdHJ1ZSA6IGZhbHNlO1xuICAvLyAgICAgLy9cbiAgLy8gICB9XG5cbiAgcmV0dXJuIHsgaXNTdW5rLCBoaXQsIF9sZW5ndGgsIHBsYWNlZCwgY29vcmRpbmF0ZXMgfTtcbn1cbiIsImltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gR2FtZWJvYXJkKCkge1xuICAvLyBlYWNoIG51bWJlciBjb3JyZXNwb25kcyB0byBpbmRleCBvZiBjdXJyZW50U2hpcHNPQkpcbiAgY29uc3QgZ2FtZUFyZW5hID0gW1xuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gICAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gICAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gICAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgXTtcblxuICBjb25zdCBjdXJyZW50U2hpcHNPQkogPSBbXG4gICAgbnVsbCxcbiAgICBTaGlwKDQpLFxuICAgIFNoaXAoMyksXG4gICAgU2hpcCgzKSxcbiAgICBTaGlwKDIpLFxuICAgIFNoaXAoMiksXG4gICAgU2hpcCgyKSxcbiAgICBTaGlwKDEpLFxuICAgIFNoaXAoMSksXG4gICAgU2hpcCgxKSxcbiAgICBTaGlwKDEpLFxuICBdO1xuXG4gIGNvbnN0IG5ld1NoaXBJbmRleCA9IChsZW5ndGgpID0+IHtcbiAgICBsZXQgaW5kZXg7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gMTA7IGkrKykge1xuICAgICAgLy8gY29uc29sZS5sb2coXCJUSElTXCIsIGN1cnJlbnRTaGlwc09CSltpXS5fbGVuZ3RoKTtcbiAgICAgIGlmIChjdXJyZW50U2hpcHNPQkpbaV0gPT0gbnVsbCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmIChcbiAgICAgICAgY3VycmVudFNoaXBzT0JKW2ldLl9sZW5ndGggPT09IGxlbmd0aCAmJlxuICAgICAgICBjdXJyZW50U2hpcHNPQkpbaV0ucGxhY2VkID09PSBmYWxzZVxuICAgICAgKSB7XG4gICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpbmRleDtcbiAgfTtcblxuICBjb25zdCBfcGxhY2VkU2hpcHMgPSBbXTtcblxuICBjb25zdCBzaGlwTnVtYmVyUnVsZXNQYXNzZWQgPSAobGVuZ3RoKSA9PiB7XG4gICAgY29uc3QgX2FsbG93ZWRPY2N1cmFuY2VzID0ge1xuICAgICAgMTogNCxcbiAgICAgIDI6IDMsXG4gICAgICAzOiAyLFxuICAgICAgNDogMSxcbiAgICB9O1xuICAgIGxldCBsZW5ndGhPY2NjdXJlZCA9IDA7XG4gICAgY29uc3QgX29jY3VyYW5jZXMgPSAodGFyZ2V0TGVuZ3RoKSA9PiB7XG4gICAgICAvLyBsZXQgY291bnRlciA9IDA7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgX3BsYWNlZFNoaXBzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChfcGxhY2VkU2hpcHNbaV0gPT09IGxlbmd0aCkge1xuICAgICAgICAgIGxlbmd0aE9jY2N1cmVkKys7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIF9vY2N1cmFuY2VzKCk7XG5cbiAgICBpZiAobGVuZ3RoT2NjY3VyZWQgPCBfYWxsb3dlZE9jY3VyYW5jZXNbbGVuZ3RoXSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGNvbnN0IHBsYWNlU2hpcCA9IChsZW5ndGgsIHgsIHksIGhvcml6b250YWxseSkgPT4ge1xuICAgIC8vIHRlc3QgdmFsaWRpdHkgb2YgY28tb3JkIG9yIGFtb3VudCBvZiBzaGlwc1xuICAgIGlmICh4IDwgMCB8fCB5IDwgMCB8fCB4ID4gMTAgfHwgeSA+IDEwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoKGUpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICBcImNhbid0IHBsYWNlIHNoaXAgaGVyZSBvciBubyBtb3JlIG9mIHRoZXNlIHNoaXBzIG9yIHNoaXAgdG9vIGJpZ1wiXG4gICAgICAgICk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoIXNoaXBOdW1iZXJSdWxlc1Bhc3NlZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKChlKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJjYW4ndCBwdXQgYW55bW9yZSBvZiB0aGVzZSBzaGlwc1wiKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGxldCBjaGVja2VkQ29vcmQ7XG5cbiAgICBjb25zdCBjaGVja0Nvb3JkID0gKCkgPT4ge1xuICAgICAgLy8gd2hhdCB3b3VsZCB0aGV5IGJlIG5haXZlbHlcblxuICAgICAgY29uc3QgbmFpdmVDb29yID0gKCgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XG5cbiAgICAgICAgaWYgKCFob3Jpem9udGFsbHkpIHtcbiAgICAgICAgICBsZXQgbmV3WSA9IHk7XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goW3gsIG5ld1ldKTtcbiAgICAgICAgICAgIG5ld1krKztcbiAgICAgICAgICAgIGlmIChuZXdZID4gMTApIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9hdCBvdXQgb2YgZ2FtZSFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGhvcml6b250YWxseSkge1xuICAgICAgICAgIGxldCBuZXdYID0geDtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaChbbmV3WCwgeV0pO1xuICAgICAgICAgICAgbmV3WCsrO1xuICAgICAgICAgICAgaWYgKG5ld1ggPiAxMCkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJCb2F0IG91dCBvZiBnYW1lIVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfSkoKTtcblxuICAgICAgY29uc3QgY2hlY2tGb3JPdmVybGFwID0gKCkgPT4ge1xuICAgICAgICBsZXQgYWxsb3dlZCA9IHRydWU7XG5cbiAgICAgICAgbmFpdmVDb29yLmZvckVhY2goKGNvb3JkaW5hdGUpID0+IHtcbiAgICAgICAgICBjb25zdCBhblggPSBjb29yZGluYXRlWzBdO1xuICAgICAgICAgIGNvbnN0IGFuWSA9IGNvb3JkaW5hdGVbMV07XG5cbiAgICAgICAgICAvLyBpbiBnYW1lYXJlbmEgZmlyc3QgaGF2ZSB0byBhY2Nlc3MgWVxuXG4gICAgICAgICAgaWYgKGdhbWVBcmVuYVthblldW2FuWF0gIT09IDApIHtcbiAgICAgICAgICAgIGFsbG93ZWQgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBhbGxvd2VkO1xuICAgICAgfTtcblxuICAgICAgaWYgKGNoZWNrRm9yT3ZlcmxhcCgpKSB7XG4gICAgICAgIGNoZWNrZWRDb29yZCA9IFsuLi5uYWl2ZUNvb3JdO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICAvLyBjb25zb2xlLmxvZyhcIlRISVNcIiwgc2hpcE51bWJlclJ1bGVzUGFzc2VkKGxlbmd0aCkpO1xuICAgIGlmIChjaGVja0Nvb3JkKCkgJiYgc2hpcE51bWJlclJ1bGVzUGFzc2VkKGxlbmd0aCkpIHtcbiAgICAgIGNvbnN0IHNoaXBPQkpJbmRleCA9IG5ld1NoaXBJbmRleChsZW5ndGgpO1xuICAgICAgY3VycmVudFNoaXBzT0JKW3NoaXBPQkpJbmRleF0ucGxhY2VkID0gdHJ1ZTtcbiAgICAgIF9wbGFjZWRTaGlwcy5wdXNoKGxlbmd0aCk7XG5cbiAgICAgIGN1cnJlbnRTaGlwc09CSltzaGlwT0JKSW5kZXhdLmNvb3JkaW5hdGVzID0gY2hlY2tlZENvb3JkO1xuICAgICAgY2hlY2tlZENvb3JkLmZvckVhY2goKGFDb29yZGluYXRlKSA9PiB7XG4gICAgICAgIGNvbnN0IG5ld3ggPSBhQ29vcmRpbmF0ZVswXTtcbiAgICAgICAgY29uc3QgbmV3eSA9IGFDb29yZGluYXRlWzFdO1xuXG4gICAgICAgIGdhbWVBcmVuYVtuZXd5XVtuZXd4XSA9IHNoaXBPQkpJbmRleDtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgbWlzc2VkU2hvdHMgPSBbXTtcblxuICBjb25zdCByZWNlaXZlQXR0YWNrID0gKHgsIHkpID0+IHtcbiAgICBpZiAoZ2FtZUFyZW5hW3ldW3hdICE9PSAwKSB7XG4gICAgICBjb25zdCBzaGlwT0JKSW5kZXggPSBnYW1lQXJlbmFbeV1beF07XG4gICAgICBjdXJyZW50U2hpcHNPQkpbc2hpcE9CSkluZGV4XS5oaXQoKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBtaXNzZWRTaG90cy5wdXNoKFt4LCB5XSk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGNvbnN0IGFsbFNoaXBzU3VuayA9ICgpID0+IHtcbiAgICBsZXQgY291bnRlciA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCAxMTsgaSsrKSB7XG4gICAgICBpZiAoY3VycmVudFNoaXBzT0JKW2ldLmlzU3VuaygpKSB7XG4gICAgICAgIGNvdW50ZXIrKztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGNvdW50ZXIgPj0gMTApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBwbGFjZVNoaXAsXG4gICAgZ2FtZUFyZW5hLFxuICAgIHJlY2VpdmVBdHRhY2ssXG4gICAgYWxsU2hpcHNTdW5rLFxuICAgIG1pc3NlZFNob3RzLFxuICAgIGN1cnJlbnRTaGlwc09CSixcbiAgfTtcbn1cbiIsImltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5cbmV4cG9ydCBkZWZhdWx0IChmdW5jdGlvbiBVSWNvbnRyb2xsZXIoKSB7XG4gIGNvbnN0IGdldEJveERPTSA9IChhcmVhLCB4LCB5KSA9PlxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2FyZWF9IC5yb3dbZGF0YS14PVwiJHt4fVwiXSAuYm94W2RhdGEteT1cIiR7eX1cIl1gKTtcblxuICBjb25zdCByZW5kZXJFeGlzdGluZ0JvYXRzID0gKGdhbWVBcmVuYSwgcGxheWVyQXJlYURPTSkgPT4ge1xuICAgIGNvbnN0IHVwZGF0ZUVhY2hET01Db29yZGluYXRlID0gKFt4LCB5XSkgPT4ge1xuICAgICAgZ2V0Qm94RE9NKHBsYXllckFyZWFET00sIHgsIHkpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiZ3JleVwiO1xuICAgIH07XG5cbiAgICBnYW1lQXJlbmEuY3VycmVudFNoaXBzT0JKLmZvckVhY2goKGFTaGlwKSA9PiB7XG4gICAgICBpZiAoYVNoaXAgPT0gbnVsbCkge1xuICAgICAgICAvLyBudWxsXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhU2hpcC5jb29yZGluYXRlcy5mb3JFYWNoKHVwZGF0ZUVhY2hET01Db29yZGluYXRlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBjaGFuZ2VCb3hDb2xvdXIgPSAoYXJlYSwgeCwgeSwgY29sb3VyKSA9PiB7XG4gICAgY29uc3QgaGl0Qm94RE9NID0gZ2V0Qm94RE9NKGFyZWEsIHgsIHkpO1xuICAgIGhpdEJveERPTS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvdXI7XG4gIH07XG5cbiAgY29uc3QgdG9nZ2xlSG92ZXJpbmcgPSAoKSA9PiB7XG4gICAgY29uc3QgYXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZW5lbXlBcmVhXCIpO1xuICAgIGFyZWEuY2xhc3NMaXN0LnRvZ2dsZShcImhvdmVyaW5nXCIpO1xuICB9O1xuXG4gIGNvbnN0IGdldEJveERPTXNTaGlwSW5kZXggPSAoZ2FtZUFyZW5hLCB4LCB5KSA9PiB7XG4gICAgY29uc3Qgc2hpcEluZGV4ID0gZ2FtZUFyZW5hLmdhbWVBcmVuYVt5XVt4XTtcbiAgICByZXR1cm4gc2hpcEluZGV4O1xuICB9O1xuXG4gIGNvbnN0IGNoYW5nZUFsbEJveGVzT2ZTaGlwID0gKHNoaXBJbmRleCwgYXJlYUNsYXNzLCBnYW1lQXJlbmEpID0+IHtcbiAgICBjb25zdCB7IGNvb3JkaW5hdGVzIH0gPSBnYW1lQXJlbmEuY3VycmVudFNoaXBzT0JKW3NoaXBJbmRleF07XG4gICAgY29vcmRpbmF0ZXMuZm9yRWFjaCgoYUNvb3JkKSA9PiB7XG4gICAgICBjb25zdCBbc2hpcFgsIHNoaXBZXSA9IGFDb29yZDtcbiAgICAgIGdldEJveERPTShgJHthcmVhQ2xhc3N9YCwgc2hpcFgsIHNoaXBZKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInJlZFwiO1xuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGdldFhhbmRZID0gKGUpID0+IHtcbiAgICBjb25zdCB7IHkgfSA9IGUudGFyZ2V0LmRhdGFzZXQ7XG4gICAgY29uc3QgeyB4IH0gPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LmRhdGFzZXQ7XG5cbiAgICByZXR1cm4gW3gsIHldO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgcmVuZGVyRXhpc3RpbmdCb2F0cyxcbiAgICBnZXRCb3hET00sXG4gICAgZ2V0WGFuZFksXG4gICAgY2hhbmdlQWxsQm94ZXNPZlNoaXAsXG4gICAgZ2V0Qm94RE9Nc1NoaXBJbmRleCxcbiAgICBjaGFuZ2VCb3hDb2xvdXIsXG4gICAgdG9nZ2xlSG92ZXJpbmcsXG4gIH07XG59KSgpO1xuIiwiaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcbmltcG9ydCBVSWNvbnRyb2xsZXIgZnJvbSBcIi4vVUljb250cm9sbGVyXCI7XG5pbXBvcnQgZW5lbXlQbGF5ZXIgZnJvbSBcIi4vY29tcHV0ZXJQbGF5ZXJcIjtcbi8vIGltcG9ydCBlbmVteVBsYXllciBmcm9tIFwiLi9jb21wdXRlclBsYXllclwiO1xuXG4vLyBjb25zdCB0ZXN0ID0gZ2V0Qm94RE9NKFwiZW5lbXlBcmVhXCIsIDAsIDApO1xuXG5jb25zdCBnYW1lTG9vcCA9ICgpID0+IHtcbiAgLy8gWzQsIDQsIDQsIDQsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAvLyBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gIC8vIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgLy8gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAvLyBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gIC8vIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgLy8gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAvLyBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gIC8vIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgLy8gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuXG4gIGNvbnN0IHNldFVwUGxhY2VtZW50cyA9IChnYW1lYm9hcmQxLCBnYW1lYm9hcmQyKSA9PiB7XG4gICAgZ2FtZWJvYXJkMS5wbGFjZVNoaXAoNCwgMCwgMCwgdHJ1ZSk7XG4gICAgZ2FtZWJvYXJkMS5wbGFjZVNoaXAoMywgNiwgMCwgdHJ1ZSk7XG4gICAgZ2FtZWJvYXJkMS5wbGFjZVNoaXAoMywgMCwgMSwgdHJ1ZSk7XG4gICAgZ2FtZWJvYXJkMS5wbGFjZVNoaXAoMiwgMCwgMywgdHJ1ZSk7XG4gICAgZ2FtZWJvYXJkMS5wbGFjZVNoaXAoMiwgMCwgNSwgdHJ1ZSk7XG4gICAgZ2FtZWJvYXJkMS5wbGFjZVNoaXAoMiwgOSwgNiwgZmFsc2UpO1xuICAgIGdhbWVib2FyZDEucGxhY2VTaGlwKDEsIDIsIDcsIHRydWUpO1xuICAgIGdhbWVib2FyZDEucGxhY2VTaGlwKDEsIDMsIDgsIHRydWUpO1xuICAgIGdhbWVib2FyZDEucGxhY2VTaGlwKDEsIDQsIDksIHRydWUpO1xuICAgIGdhbWVib2FyZDEucGxhY2VTaGlwKDEsIDcsIDksIHRydWUpO1xuXG4gICAgZ2FtZWJvYXJkMi5wbGFjZVNoaXAoNCwgMCwgMCwgdHJ1ZSk7XG4gICAgZ2FtZWJvYXJkMi5wbGFjZVNoaXAoMywgNiwgMCwgdHJ1ZSk7XG4gICAgZ2FtZWJvYXJkMi5wbGFjZVNoaXAoMywgMCwgMSwgdHJ1ZSk7XG4gICAgZ2FtZWJvYXJkMi5wbGFjZVNoaXAoMiwgMCwgMywgdHJ1ZSk7XG4gICAgZ2FtZWJvYXJkMi5wbGFjZVNoaXAoMiwgMCwgNSwgdHJ1ZSk7XG4gICAgZ2FtZWJvYXJkMi5wbGFjZVNoaXAoMiwgOSwgNiwgZmFsc2UpO1xuICAgIGdhbWVib2FyZDIucGxhY2VTaGlwKDEsIDIsIDcsIHRydWUpO1xuICAgIGdhbWVib2FyZDIucGxhY2VTaGlwKDEsIDMsIDgsIHRydWUpO1xuICAgIGdhbWVib2FyZDIucGxhY2VTaGlwKDEsIDQsIDksIHRydWUpO1xuICAgIGdhbWVib2FyZDIucGxhY2VTaGlwKDEsIDcsIDksIHRydWUpO1xuICB9O1xuXG4gIC8vICAgZGVidWdnZXI7XG5cbiAgLy8gICB3aGlsZSAoIWdhbWVPdmVyKSB7XG4gIGNvbnN0IHBsYXllckdhbWVib2FyZCA9IEdhbWVib2FyZCgpO1xuICBjb25zdCBlbmVteUdhbWVib2FyZCA9IEdhbWVib2FyZCgpO1xuICBzZXRVcFBsYWNlbWVudHMocGxheWVyR2FtZWJvYXJkLCBlbmVteUdhbWVib2FyZCk7XG4gIGxldCBnYW1lT0sgPSB0cnVlO1xuXG4gIFVJY29udHJvbGxlci5yZW5kZXJFeGlzdGluZ0JvYXRzKHBsYXllckdhbWVib2FyZCwgXCJwbGF5ZXJBcmVhXCIpO1xuICAvLyAgIFVJY29udHJvbGxlci5lbmVteUJveERPTUxpc3RlbmVyKGVuZW15R2FtZWJvYXJkKTtcbiAgLy8gICBjb25zb2xlLmxvZyhcImhhcHBlbnNcIik7XG5cbiAgY29uc3QgaGFuZGxlUGxheWVyQ2xpY2sgPSAoZSkgPT4ge1xuICAgIGNvbnN0IGJveERvbSA9IGUudGFyZ2V0O1xuICAgIGNvbnN0IFt4LCB5XSA9IFVJY29udHJvbGxlci5nZXRYYW5kWShlKTtcbiAgICBjb25zdCBzaGlwSW5kZXggPSBVSWNvbnRyb2xsZXIuZ2V0Qm94RE9Nc1NoaXBJbmRleChlbmVteUdhbWVib2FyZCwgeCwgeSk7XG4gICAgLy8gY29uc29sZS5sb2coXCJldmFsdWF0aW5nXCIsIGJveERvbS5kYXRhc2V0LmhpdCk7XG5cbiAgICBpZiAoIWJveERvbS5kYXRhc2V0LmhpdCkge1xuICAgICAgYm94RG9tLmRhdGFzZXQuaGl0ID0gdHJ1ZTtcbiAgICAgIHJtdkV2ZW50TGlzdGVuZXJBbmRFbmVteVR1cm4oKTtcbiAgICAgIC8vICAgY29uc29sZS5sb2coXCJib29tXCIpO1xuICAgICAgY29uc3QgYXR0YWNrUmVzdWx0ID0gZW5lbXlHYW1lYm9hcmQucmVjZWl2ZUF0dGFjayh4LCB5KTtcbiAgICAgIC8vICAgY29uc29sZS5sb2coXCJhdHRhY2tSZXN1bHRcIiwgYXR0YWNrUmVzdWx0KTtcbiAgICAgIGlmIChhdHRhY2tSZXN1bHQpIHtcbiAgICAgICAgY29uc3Qgc2hpcE9CSiA9IGVuZW15R2FtZWJvYXJkLmN1cnJlbnRTaGlwc09CSltzaGlwSW5kZXhdO1xuICAgICAgICBib3hEb20uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJncmV5XCI7XG5cbiAgICAgICAgaWYgKHNoaXBPQkouaXNTdW5rKCkpIHtcbiAgICAgICAgICBVSWNvbnRyb2xsZXIuY2hhbmdlQWxsQm94ZXNPZlNoaXAoXG4gICAgICAgICAgICBzaGlwSW5kZXgsXG4gICAgICAgICAgICBcImVuZW15QXJlYVwiLFxuICAgICAgICAgICAgZW5lbXlHYW1lYm9hcmRcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlbmVteUdhbWVib2FyZC5hbGxTaGlwc1N1bmsoKSkge1xuICAgICAgICAgIGFsZXJ0KFwiZ2FtZSBPdmVyXCIpO1xuICAgICAgICAgIGdhbWVPSyA9IGZhbHNlO1xuICAgICAgICAgIC8vICAgcmVtb3ZpbmdFdmVudExpc3RlbmVycygpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBib3hEb20uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJyZ2IoMTkwLCAxNDYsIDE1NClcIjtcbiAgICAgICAgLy8gcmVtb3ZpbmdFdmVudExpc3RlbmVycygpO1xuICAgICAgfVxuICAgICAgZW5lbXlUdXJuKCk7XG4gICAgfVxuXG4gICAgLy8gY29uc29sZS5sb2coc2hpcEluZGV4KTtcbiAgfTtcblxuICBjb25zdCBwbGF5ZXJzVHVybiA9ICgpID0+IHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuZW5lbXlBcmVhIC5yb3cgLmJveGApLmZvckVhY2goKGFCb3gpID0+IHtcbiAgICAgIGFCb3guYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZVBsYXllckNsaWNrLCB7IG9uY2U6IHRydWUgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3Qgcm12RXZlbnRMaXN0ZW5lckFuZEVuZW15VHVybiA9ICgpID0+IHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuZW5lbXlBcmVhIC5yb3cgLmJveGApLmZvckVhY2goKGFCb3gpID0+IHtcbiAgICAgIGFCb3gucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZVBsYXllckNsaWNrKTtcbiAgICB9KTtcblxuICAgIFVJY29udHJvbGxlci50b2dnbGVIb3ZlcmluZygpO1xuICB9O1xuXG4gIGNvbnN0IGVuZW15Qm90ID0gZW5lbXlQbGF5ZXIocGxheWVyR2FtZWJvYXJkKTtcbiAgY29uc3QgZW5lbXlUdXJuID0gKCkgPT4ge1xuICAgIGlmICghZ2FtZU9LKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vICAgZW5lbXkncyB0dXJuXG4gICAgLy8gICBjb25zb2xlLmxvZyhlbmVteUJvdCk7XG4gICAgY29uc3QgW2lzSGl0LCB4LCB5XSA9IGVuZW15Qm90LmF0dGFjaygpO1xuXG4gICAgY29uc3QgYm94RE9NID0gVUljb250cm9sbGVyLmdldEJveERPTShcInBsYXllckFyZWFcIiwgeCwgeSk7XG5cbiAgICBpZiAoaXNIaXQpIHtcbiAgICAgIGNvbnN0IGVuZW15U2hpcEluZGV4ID0gVUljb250cm9sbGVyLmdldEJveERPTXNTaGlwSW5kZXgoXG4gICAgICAgIHBsYXllckdhbWVib2FyZCxcbiAgICAgICAgeCxcbiAgICAgICAgeVxuICAgICAgKTtcbiAgICAgIGNvbnN0IHNoaXBPQkogPSBwbGF5ZXJHYW1lYm9hcmQuY3VycmVudFNoaXBzT0JKW2VuZW15U2hpcEluZGV4XTtcblxuICAgICAgYm94RE9NLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicGlua1wiO1xuICAgICAgcGxheWVyc1R1cm4oKTtcbiAgICAgIGlmIChzaGlwT0JKLmlzU3VuaygpKSB7XG4gICAgICAgIFVJY29udHJvbGxlci5jaGFuZ2VBbGxCb3hlc09mU2hpcChcbiAgICAgICAgICBlbmVteVNoaXBJbmRleCxcbiAgICAgICAgICBcInBsYXllckFyZWFcIixcbiAgICAgICAgICBwbGF5ZXJHYW1lYm9hcmRcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gICBjb25zb2xlLmxvZyhib3hET00pO1xuICAgICAgYm94RE9NLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmdiKDE5MCwgMTQ2LCAxNTQpXCI7XG4gICAgICBwbGF5ZXJzVHVybigpO1xuICAgIH1cbiAgfTtcblxuICBwbGF5ZXJzVHVybigpO1xufTtcblxuZ2FtZUxvb3AoKTtcbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGVuZW15UGxheWVyKGh1bWFuQm9hcmQpIHtcbiAgLy8gbWluIGlzIGluY2x1c2l2ZSBtYXggaXMgZXhjbHVzaXZlXG5cbiAgY29uc3QgbW92ZXNEb25lID0gW107XG4gIGNvbnNvbGUubG9nKG1vdmVzRG9uZSk7XG4gIGNvbnN0IGdldFJhbmRvbUNvb3JkID0gKCkgPT4ge1xuICAgIGNvbnN0IHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgY29uc3QgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICBjb25zdCBmb3VuZEVsZW1lbnQgPSBtb3Zlc0RvbmUuZmluZChcbiAgICAgIChlbGVtZW50KSA9PiBlbGVtZW50WzBdID09PSB4ICYmIGVsZW1lbnRbMV0gPT09IHlcbiAgICApO1xuXG4gICAgaWYgKGZvdW5kRWxlbWVudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gZ2V0UmFuZG9tQ29vcmQoKTtcbiAgICB9XG4gICAgcmV0dXJuIFt4LCB5XTtcbiAgfTtcblxuICBjb25zdCBhdHRhY2sgPSAoKSA9PiB7XG4gICAgY29uc3QgW3gsIHldID0gZ2V0UmFuZG9tQ29vcmQoKTtcbiAgICBjb25zb2xlLmxvZyhcInJhbmRvbSBjb29yZFwiLCB4LCB5KTtcblxuICAgIGNvbnN0IGlzSGl0ID0gaHVtYW5Cb2FyZC5yZWNlaXZlQXR0YWNrKHgsIHkpO1xuICAgIG1vdmVzRG9uZS5wdXNoKFt4LCB5XSk7XG4gICAgcmV0dXJuIFtpc0hpdCwgeCwgeV07XG4gIH07XG5cbiAgcmV0dXJuIHsgYXR0YWNrIH07XG59XG4iXSwibmFtZXMiOlsiU2hpcCIsImxlbmd0aCIsIl9oaXRzIiwiX2xlbmd0aCIsImlzU3VuayIsImhpdCIsInBsYWNlZCIsImNvb3JkaW5hdGVzIiwiR2FtZWJvYXJkIiwiZ2FtZUFyZW5hIiwiY3VycmVudFNoaXBzT0JKIiwiX3BsYWNlZFNoaXBzIiwic2hpcE51bWJlclJ1bGVzUGFzc2VkIiwibGVuZ3RoT2NjY3VyZWQiLCJ0YXJnZXRMZW5ndGgiLCJpIiwiX29jY3VyYW5jZXMiLCJtaXNzZWRTaG90cyIsInBsYWNlU2hpcCIsIngiLCJ5IiwiaG9yaXpvbnRhbGx5IiwiRXJyb3IiLCJlIiwiY29uc29sZSIsImVycm9yIiwiY2hlY2tlZENvb3JkIiwibmFpdmVDb29yIiwicmVzdWx0IiwibmV3WCIsInB1c2giLCJuZXdZIiwiYWxsb3dlZCIsImZvckVhY2giLCJjb29yZGluYXRlIiwiYW5YIiwiYW5ZIiwiY2hlY2tGb3JPdmVybGFwIiwiY2hlY2tDb29yZCIsInNoaXBPQkpJbmRleCIsImluZGV4IiwibmV3U2hpcEluZGV4IiwiYUNvb3JkaW5hdGUiLCJuZXd4IiwibmV3eSIsInJlY2VpdmVBdHRhY2siLCJhbGxTaGlwc1N1bmsiLCJjb3VudGVyIiwiZ2V0Qm94RE9NIiwiYXJlYSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInJlbmRlckV4aXN0aW5nQm9hdHMiLCJwbGF5ZXJBcmVhRE9NIiwidXBkYXRlRWFjaERPTUNvb3JkaW5hdGUiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsImFTaGlwIiwiZ2V0WGFuZFkiLCJ0YXJnZXQiLCJkYXRhc2V0IiwicGFyZW50RWxlbWVudCIsImNoYW5nZUFsbEJveGVzT2ZTaGlwIiwic2hpcEluZGV4IiwiYXJlYUNsYXNzIiwiYUNvb3JkIiwic2hpcFgiLCJzaGlwWSIsImdldEJveERPTXNTaGlwSW5kZXgiLCJjaGFuZ2VCb3hDb2xvdXIiLCJjb2xvdXIiLCJ0b2dnbGVIb3ZlcmluZyIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInBsYXllckdhbWVib2FyZCIsImVuZW15R2FtZWJvYXJkIiwiZ2FtZWJvYXJkMSIsImdhbWVib2FyZDIiLCJnYW1lT0siLCJVSWNvbnRyb2xsZXIiLCJoYW5kbGVQbGF5ZXJDbGljayIsImJveERvbSIsInJtdkV2ZW50TGlzdGVuZXJBbmRFbmVteVR1cm4iLCJzaGlwT0JKIiwiYWxlcnQiLCJlbmVteVR1cm4iLCJwbGF5ZXJzVHVybiIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhQm94IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uY2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZW5lbXlCb3QiLCJodW1hbkJvYXJkIiwibW92ZXNEb25lIiwibG9nIiwiZ2V0UmFuZG9tQ29vcmQiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ1bmRlZmluZWQiLCJmaW5kIiwiZWxlbWVudCIsImF0dGFjayIsImlzSGl0IiwiZW5lbXlQbGF5ZXIiLCJib3hET00iLCJlbmVteVNoaXBJbmRleCIsImdhbWVMb29wIl0sInNvdXJjZVJvb3QiOiIifQ==